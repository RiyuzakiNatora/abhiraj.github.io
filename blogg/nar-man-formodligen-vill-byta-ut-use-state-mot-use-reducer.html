<!DOCTYPE html><html lang="sv"><head><meta charSet="utf-8"/><meta name="viewport" content="initial-scale=1.0, width=device-width"/><meta property="og:url" content="danielvernberg.se"/><meta property="og:locale" content="sv_SE"/><link rel="canonical" href="danielvernberg.se"/><title>N√§r man f√∂rmodligen vill byta ut useState mot useReducer - Daniel Vernberg</title><meta name="robots" content="index,follow"/><meta name="googlebot" content="index,follow"/><meta name="description" content="Hook:en useState √§r bra till mycket. Men ibland r√§cker inte den inte hela v√§gen. Det h√§r √§r lite reflektioner √∂ver f√∂rsta g√•ngen jag anv√§nde useReducer f√∂r att l√∂sa lite mer avancerad state."/><meta property="og:title" content="N√§r man f√∂rmodligen vill byta ut useState mot useReducer"/><meta property="og:description" content="Hook:en useState √§r bra till mycket. Men ibland r√§cker inte den inte hela v√§gen. Det h√§r √§r lite reflektioner √∂ver f√∂rsta g√•ngen jag anv√§nde useReducer f√∂r att l√∂sa lite mer avancerad state."/><meta property="og:type" content="article"/><meta property="article:published_time" content="2021-02-13T00:00:00.000Z"/><meta name="next-head-count" content="13"/><link rel="icon" href="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text y=%22.9em%22 font-size=%2290%22&gt;üë®‚Äçüíª&lt;/text&gt;&lt;/svg&gt;"/><link rel="preconnect" href="https://fonts.googleapis.com"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="true"/><style id="stitches">--sxs{--sxs:0 t-fyIhqy}@media{:root,.t-fyIhqy{--radii-small:4px;--radii-default:6px;--radii-rouded:10000px;--shadows-main:0px 4px 10px rgba(0, 0, 0, 0.09);--shadows-button:0px 4px 7px hsl(223.10000000000002, 100%, 87.5%);--shadows-buttonHover:0px 4px 10px hsl(223.10000000000002, 100%, 77%);--colors-primary:#6691FF;--colors-primaryDarken:#5484FF;--colors-secondary:#3fc179;--colors-backgroundColor:#FFF;--colors-backgroundColorSecondary:#FFF;--colors-backgroundColorHighlight:#EEF3FF;--colors-backgroundColorNavBar:hsl(0deg 0% 100% / 75%);--colors-textColor:#585858;--colors-textMutedColor:#a2a2a2;--colors-headingColor:#444444;--colors-backgroundGradient:linear-gradient(45deg, var(--colors-primary), var(--colors-secondary));--colors-backgroundGradintDarker:linear-gradient(45deg, var(--colors-primaryDarken), var(--colors-secondary));--fonts-main:'Quicksand', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;;--fonts-headings:'Quicksand', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;;--fonts-mono:'Fira Code', Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;--fontSizes-0:0.8rem;--fontSizes-1:0.9rem;--fontSizes-2:1rem;--fontSizes-3:1.1rem;--fontSizes-4:1.2rem;--fontSizes-5:1.3rem;--fontSizes-6:1.5rem;--fontSizes-7:2rem;--fontSizes-base:16px;--fontSizes-baseDesktop:18px;--fontSizes-small:var(--fontSizes-1);--fontSizes-smaller:var(--fontSizes-0);--fontSizes-code:var(--fontSizes-0);--fontSizes-h1:var(--fontSizes-7);--fontSizes-h2:var(--fontSizes-6);--fontSizes-h3:var(--fontSizes-5);--fontSizes-h4:var(--fontSizes-4);--fontSizes-h5:var(--fontSizes-3);--fontSizes-h6:var(--fontSizes-2);--space-small:5px;--space-medium:10px;--space-large:20px;--space-mega:40px;--sizes-small:5px;--sizes-medium:10px;--sizes-large:20px;--sizes-mega:40px;--sizes-siteWidth:800px}}--sxs{--sxs:1 kUuBfw}@media{html,body,div,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td,article,aside,canvas,details,embed,figure,figcaption,footer,header,hgroup,main,menu,nav,output,ruby,section,summary,time,mark,audio,video{margin:0;padding:0;border:0;font-size:100%;font:inherit;vertical-align:baseline}article,aside,details,figcaption,figure,footer,header,hgroup,main,menu,nav,section{display:block}*[hidden]{display:none}body{background:var(--colors-backgroundColor);color:var(--colors-textColor);font-family:var(--fonts-main);font-weight:500}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:none}table{border-spacing:0}html{font-size:var(--fontSizes-base);-webkit-text-size-adjust:none;text-size-adjust:none}@media (min-width: 1024px){html{font-size:var(--fontSizes-baseDesktop)}}h1,h2,h3,h4,h5,h6{font-family:var(--fonts-headings);color:var(--colors-headingColor);line-height:1.2;letter-spacing:-0.5px;margin-top:1rem}h1,h2{margin-bottom:1rem;font-weight:700}h3,h4,h5,h6{font-weight:600;margin-bottom:0.7rem}h1{font-size:var(--fontSizes-h1)}h2{font-size:var(--fontSizes-h2)}h3{font-size:var(--fontSizes-h3)}h4{font-size:var(--fontSizes-h4)}h5{font-size:var(--fontSizes-h5)}h6{font-size:var(--fontSizes-h6)}a{color:var(--colors-primary);font-weight:bold;text-decoration:none;font-size:1rem;cursor:pointer}a:hover{text-decoration:underline}p,li{line-height:1.6}p{margin:0 0 1.2rem;overflow-wrap:break-word}ul{list-style:disc}ul li::marker{color:var(--colors-primary);font-size:var(--fontSizes-5)}ol{list-style:decimal}ol li::marker{color:var(--colors-primary);font-weight:bold;font-style:italic}ul,ol{margin-bottom:10px;padding-inline-start:1rem}li{margin:var(--space-medium) var(--space-small)}img{max-width:100%}pre{border-radius:var(--radii-default);font-size:1rem}blockquote{margin:0 0 1rem 0;padding:1rem;background:var(--colors-backgroundColorHighlight);border-radius:0.3rem}blockquote p{margin-bottom:0}code{font-family:var(--fonts-mono);font-size:var(--fontSizes-code);color:var(--colors-textColor);font-weight:bold}code:not([class^="language"]):after,code:not([class^="language"]):before{content:"`";font-weight:bold}strong{font-weight:bold;color:var(--colors-headingColor)}em{font-style:italic}span.token{font-size:var(--fontSizes-code)}}--sxs{--sxs:2 c-jGAclF c-bFBiOr c-bkUlwM c-bZNrxE c-gHYpeN c-jyhawZ c-hNeJhr c-cZmHrB c-dhzjXW PJLV c-jpsCDP c-dVkrah c-fixGjY c-PJLV c-jNUAyN c-gATxoi c-bPgfrJ c-bQzyIt c-bImmwG c-jKTQyv}@media{.c-jGAclF{box-shadow:var(--shadows-main);position:fixed;width:100%;background:var(--colors-backgroundColor);z-index:999}@supports (backdrop-filter: blur(20px)){.c-jGAclF{-webkit-backdrop-filter:blur(20px);backdrop-filter:blur(20px);background:var(--colors-backgroundColorNavBar)}}.c-bFBiOr{width:100%;max-width:var(--sizes-siteWidth);margin:0 auto}.c-bkUlwM{margin:0 var(--space-large)}.c-bZNrxE{display:flex;flex-direction:row}.c-gHYpeN{width:100%;height:60px;align-items:center;font-family:var(--fonts-headings);font-weight:bold;font-size:var(--fontSizes-5)}.c-jyhawZ{font-weight:inherit;color:inherit;margin:0;padding:0}.c-jyhawZ:hover{text-decoration:none}.c-hNeJhr{color:var(--colors-textMutedColor)}.c-cZmHrB{flex:1}.c-dhzjXW{display:flex}.c-jpsCDP{padding-top:60px}.c-dVkrah{---tokenBackground:#2E3440;---tokenBackgroundHighlight:#3C4453;---tokenCommentColor:#636f88;---tokenRegexColor:#ebcb8b;---tokenPropertyColor:#81A1C1;---tokenNumberColor:#B48EAD;---tokenSelectorColor:rgb(199, 146, 234);---tokenBooleanColor:var(---tokenPropertyColor);---tokenPunctuationColor:#81A1C1;---tokenFunctionColor:#88C0D0;---tokenStringColor:#A3BE8C;---tokenOperator:#81A1C1;---tokenBaseColor:#f8f8f2}.c-dVkrah code[class*="language-"],.c-dVkrah pre[class*="language-"]{color:var(---tokenBaseColor);background:none;display:block;font-family:var(--fonts-mono);text-align:left;font-weight:400;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;tab-size:4;-webkit-hyphens:none;hyphens:none}.c-dVkrah pre[class*="language-"]{padding:1em;margin:0.5em 0 1em;margin-top:0;overflow:auto;border-radius:var(--radii-small)}.c-dVkrah :not(pre) > code[class*="language-"],.c-dVkrah pre[class*="language-"]{background:var(---tokenBackground)}.c-dVkrah :not(pre) > code[class*="language-"]{padding:01.em;border-radius:var(--radii-small);white-space:normal}.c-dVkrah .token.comment,.c-dVkrah .token.prolog,.c-dVkrah .token.doctype,.c-dVkrah .token.cdata{color:var(---tokenCommentColor)}.c-dVkrah .token.punctuation{color:var(---tokenPunctuationColor)}.c-dVkrah .namespace{opacity:0.7}.c-dVkrah .token.property,.c-dVkrah .token.tag,.c-dVkrah .token.constant,.c-dVkrah .token.symbol,.c-dVkrah .token.deleted{color:var(---tokenPropertyColor)}.c-dVkrah .token.number{color:var(---tokenNumberColor)}.c-dVkrah .token.boolean{color:var(---tokenBooleanColor)}.c-dVkrah .token.selector,.c-dVkrah .token.attr-name,.c-dVkrah .token.string,.c-dVkrah .token.char,.c-dVkrah .token.builtin,.c-dVkrah .token.inserted{color:var(---tokenStringColor)}.c-dVkrah .token.operator,.c-dVkrah .token.entity,.c-dVkrah .token.url,.c-dVkrah .language-css .token.string,.c-dVkrah .style .token.string,.c-dVkrah .token.variable{color:var(---tokenOperator)}.c-dVkrah .token.atrule,.c-dVkrah .token.attr-value,.c-dVkrah .token.function,.c-dVkrah .token.class-name{color:var(---tokenFunctionColor)}.c-dVkrah .token.keyword{color:var(---tokenPropertyColor)}.c-dVkrah .token.regex,.c-dVkrah .token.important{color:var(---tokenRegexColor)}.c-dVkrah .token.important,.c-dVkrah .token.bold{font-weight:bold}.c-dVkrah .token.italic{font-style:italic}.c-dVkrah .token.entity{cursor:help}.c-dVkrah .rehype-code-title{max-width:100%;overflow-y:hidden;font-family:var(--fonts-mono);margin-bottom:-0.8rem;padding:0.7em 1em 0.5em 1em;background:var(---tokenBackground);text-aligh:left;font-weight:400;color:var(---tokenCommentColor);border-top-right-radius:4px;border-top-left-radius:4px;font-size:var(--fontSizes-small);z-index:1}.c-dVkrah .code-highlight{float:left;min-width:97%}.c-dVkrah .highlight-line{background:var(---tokenBackgroundHighlight);display:block;margin-left:-30px;padding-left:30px;margin-right:-30px;padding-right:30px}.c-dVkrah .line-number::before{display:inline-block;width:1rem;text-align:right;margin-right:16px;margin-left:-8px;color:var(---tokenCommentColor);content:attr(line)}.c-fixGjY{display:flex;flex-direction:column}.c-jNUAyN{color:var(--colors-textMutedColor);font-size:var(--fontSizes-small);font-weight:400}.c-gATxoi{margin-bottom:0px}.c-bPgfrJ{background:var(--colors-backgroundColorHighlight);width:100%;height:2px}.c-bQzyIt{display:grid}.c-bImmwG{border-radius:var(--radii-default);background:var(--colors-backgroundColorSecondary);padding:var(--space-small);box-shadow:0px 4px 7px rgba(0, 0, 0, 0.09);transition:box-shadow 0.2s ease}.c-bImmwG:hover{box-shadow:0px 8px 15px rgba(0, 0, 0, 0.09)}.c-jKTQyv{margin:0;color:var(--colors-textMutedColor);font-weight:bold}}--sxs{--sxs:3 c-dhzjXW-fmMVkQ-size-small c-dhzjXW-oSmJK-size-large c-PJLV-jvCEVg-gradient-true c-dhzjXW-AlumW-size-medium}@media{.c-dhzjXW-fmMVkQ-size-small{max-width:var(--sizes-small);min-width:var(--sizes-small);margin:var(--space-small)}.c-dhzjXW-oSmJK-size-large{max-width:var(--sizes-large);min-width:var(--sizes-large);margin:var(--space-large)}.c-PJLV-jvCEVg-gradient-true{background-image:var(--colors-backgroundGradient);background-size:100%;background-repeat:repeat;-webkit-background-clip:text;background-clip:text;-webkit-background-clip:text;-webkit-text-fill-color:transparent}.c-dhzjXW-AlumW-size-medium{max-width:var(--sizes-medium);min-width:var(--sizes-medium);margin:var(--space-medium)}}--sxs{--sxs:6 c-bZNrxE-iiNNtQg-css PJLV-idhzjXW-css PJLV-ieKjzkc-css c-bQzyIt-ikUNLjE-css PJLV-igsmDXe-css c-bZNrxE-ilkBNdM-css c-fixGjY-iirEjuD-css c-jNUAyN-ihtBelh-css c-PJLV-idFXbZW-css}@media{.c-bZNrxE-iiNNtQg-css{align-items:center;cursor:pointer}.PJLV-ieKjzkc-css{display:inline-block;vertical-align:middle;overflow:hidden;fill:var(--colors-textMutedColor)}.PJLV-idhzjXW-css{display:flex}.c-bQzyIt-ikUNLjE-css{grid-template-columns:repeat(auto-fit, minmax(250px, 1fr));grid-column-gap:20px;grid-row-gap:20px}.c-bZNrxE-ilkBNdM-css{height:100%}.c-fixGjY-iirEjuD-css{align-items:stretch}.c-jNUAyN-ihtBelh-css{font-size:var(--fontSizes-smaller)}.c-PJLV-idFXbZW-css{margin-top:0}.PJLV-igsmDXe-css{cursor:pointer}}</style><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin /><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-9b312e20a4e32339.js" defer=""></script><script src="/_next/static/chunks/framework-5f4595e5518b5600.js" defer=""></script><script src="/_next/static/chunks/main-62be57948b11b758.js" defer=""></script><script src="/_next/static/chunks/pages/_app-b0867eecb36958b1.js" defer=""></script><script src="/_next/static/chunks/pages/blogg/%5Bslug%5D-4583c93b7baa87d4.js" defer=""></script><script src="/_next/static/TtVAyZFKtHZIk9MUUdl5Z/_buildManifest.js" defer=""></script><script src="/_next/static/TtVAyZFKtHZIk9MUUdl5Z/_ssgManifest.js" defer=""></script><style data-href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;500;700&display=swap">@font-face{font-family:'Quicksand';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/quicksand/v30/6xK-dSZaM9iE8KbpRA_LJ3z8mH9BOJvgkP8o18I.woff) format('woff')}@font-face{font-family:'Quicksand';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/quicksand/v30/6xK-dSZaM9iE8KbpRA_LJ3z8mH9BOJvgkM0o18I.woff) format('woff')}@font-face{font-family:'Quicksand';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/quicksand/v30/6xK-dSZaM9iE8KbpRA_LJ3z8mH9BOJvgkBgv18I.woff) format('woff')}@font-face{font-family:'Quicksand';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/quicksand/v30/6xKtdSZaM9iE8KbpRA_hJFQNYuDyP7bh.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Quicksand';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/quicksand/v30/6xKtdSZaM9iE8KbpRA_hJVQNYuDyP7bh.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Quicksand';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/quicksand/v30/6xKtdSZaM9iE8KbpRA_hK1QNYuDyPw.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Quicksand';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/quicksand/v30/6xKtdSZaM9iE8KbpRA_hJFQNYuDyP7bh.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Quicksand';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/quicksand/v30/6xKtdSZaM9iE8KbpRA_hJVQNYuDyP7bh.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Quicksand';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/quicksand/v30/6xKtdSZaM9iE8KbpRA_hK1QNYuDyPw.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Quicksand';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/quicksand/v30/6xKtdSZaM9iE8KbpRA_hJFQNYuDyP7bh.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Quicksand';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/quicksand/v30/6xKtdSZaM9iE8KbpRA_hJVQNYuDyP7bh.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Quicksand';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/quicksand/v30/6xKtdSZaM9iE8KbpRA_hK1QNYuDyPw.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}</style></head><body><div id="__next" data-reactroot=""><div class="c-jGAclF"><div class="c-bFBiOr"><div class="c-bkUlwM"><div class="c-bZNrxE c-gHYpeN"><a href="/" class="c-jyhawZ"><span class="c-hNeJhr">Daniel Vernberg</span></a><div class="c-cZmHrB"></div><div class="c-bZNrxE c-bZNrxE-iiNNtQg-css"><a href="/blogg" class="c-jyhawZ"><span class="c-hNeJhr">Blogg</span></a><div class="c-dhzjXW c-dhzjXW-fmMVkQ-size-small"></div><div class="PJLV PJLV-idhzjXW-css"><svg viewBox="0 0 24 24" height="24px" width="24px" class="PJLV PJLV-ieKjzkc-css"><path d="M12.3 22h-.1a10.31 10.31 0 01-7.34-3.15 10.46 10.46 0 01-.26-14 10.13 10.13 0 014-2.74 1 1 0 011.06.22 1 1 0 01.24 1 8.4 8.4 0 001.94 8.81 8.47 8.47 0 008.83 1.94 1 1 0 011.27 1.29A10.16 10.16 0 0119.6 19a10.28 10.28 0 01-7.3 3zM7.46 4.92a7.93 7.93 0 00-1.37 1.22 8.44 8.44 0 00.2 11.32A8.29 8.29 0 0012.22 20h.08a8.34 8.34 0 006.78-3.49A10.37 10.37 0 017.46 4.92z" data-name="moon"></path></svg></div></div></div></div></div></div><div class="c-jpsCDP"><div class="c-dVkrah"><div class="c-bFBiOr"><div class="c-bkUlwM"><div class="c-fixGjY"><div class="c-dhzjXW c-dhzjXW-oSmJK-size-large"></div><h1 class="c-PJLV c-PJLV-jvCEVg-gradient-true">N√§r man f√∂rmodligen vill byta ut useState mot useReducer</h1><p class="c-jNUAyN c-gATxoi">2021-02-13</p><div class="c-dhzjXW c-dhzjXW-AlumW-size-medium"></div><p>Det h√§r √§r en genomg√•ng och reflektioner av hur det gick till n√§r jag f√∂r f√∂rsta g√•ngen anv√§nde useReducer som ett rimligare alternativ till useState, p√• grund av ett multi-steg-formul√§rs komplexitet.</p>
<h2 id="kort-om-usestate"><a aria-hidden="true" tabindex="-1" href="#kort-om-usestate"><span class="icon icon-link"></span></a>Kort om useState</h2>
<p>React-hook:en <code>useState</code> √§r v√§ldigt smidig att anv√§nda n√§r man vill g√∂ra en funktionskomponent stateful. Det √§r relativt l√§tt att h√§mta lite data asynkront fr√•n ett API och s√§tta det i state, eller koppla ihop inputf√§ltv√§rden med state.</p>
<p>En uppenbar skillnad mellan useState och hur man ofta skriver och s√§tter state i klasskomponenter √§r att man via useState kan ha flera ‚Äùstate-variabler‚Äù, medan man i en klass-komponent jobbar med state som ett objekt.</p>
<p>S√§g att man har ett formul√§r och vill anv√§nda useState f√∂r state-hantering med 3-4 inputf√§lt. Det enklaste √§r nog att ha separata state-variabler f√∂r varje inputf√§lt, ungef√§r s√• h√§r:</p>
<pre class="language-ts"><code class="language-ts code-highlight"><span class="code-line line-number" line="1"><span class="token keyword">const</span> <span class="token punctuation">[</span>inputOne<span class="token punctuation">,</span> setInputOne<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span>‚Äô‚Äô<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="2"><span class="token keyword">const</span> <span class="token punctuation">[</span>inputTwo<span class="token punctuation">,</span> setInputTwo<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span>‚Äô‚Äô<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="3"><span class="token keyword">const</span> <span class="token punctuation">[</span>inputThree<span class="token punctuation">,</span> setInputThree<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span>‚Äô‚Äô<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="4"><span class="token keyword">const</span> <span class="token punctuation">[</span>inputFour<span class="token punctuation">,</span> setInputFour<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span>‚Äô‚Äô<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></code></pre>
<p>Att separera state f√∂r ett formul√§r p√• det h√§r s√§ttet kanske √§r det mest uppenbara tillv√§gag√•ngss√§ttet. Ett alternativ f√∂r n√§r ett formul√§r, eller vilken sorts komponent som helst egentligen som beh√∂ver state, inte √§r speciellt komplext och n√§r det inte finns s√• m√•nga ‚Äùnyanser‚Äù i hur state:t kan se ut.</p>
<p>N√§r man d√• ist√§llet beh√∂ver lite komplexare state-hantering kan det kanske ses naturligt att gruppera state i ett objekt ist√§llet, likt state f√∂r en klass-komponent. Detta kan framf√∂r allt vara bra f√∂r att man f√•r en b√§ttre √∂verblick √∂ver hur en komponents state ser ut, ist√§llet f√∂r att man har v√§ldigt m√•nga individuella <code>const [state, setState] = useState()</code> att h√•lla reda p√•.</p>
<p>√ñversk√•dligheten blir om √§nnu b√§ttre om man anv√§nder TypeScript och kan typa upp sitt useState objekt.</p>
<h3 id="n√§r-usestate-inte-r√§cker-till"><a aria-hidden="true" tabindex="-1" href="#n√§r-usestate-inte-r√§cker-till"><span class="icon icon-link"></span></a>N√§r useState inte r√§cker till</h3>
<p>R√§cker det d√• att forts√§tta anv√§nda useState tillsammans med ett objekt ist√§llet och l√•ta formul√§ret/funktionskomponent sk√∂ta lite komplexare state-logik? Inte riktigt. Den officiella dokumentationen f√∂r React <a href="https://reactjs.org/docs/hooks-reference.html">rekommenderar</a> att man ist√§llet ska anv√§nda hook:en <code>useReducer</code>, med motiveringen:</p>
<blockquote>
<p><strong>useReducer</strong> is usually preferable to <strong>useState</strong> when you have complex state logic that involves multiple sub-values or when the next state depends on the previous one</p>
</blockquote>
<p>Flera individuella useState-variabler, ett enda state-objekt och sen useReducer. Det √§r i stora drag de tre olika stadier som jag och en kollega gick igenom n√§r vi f√∂r ett tag sedan i ett projekt skulle bygga ett multi-stegs formul√§r. Ett formul√§r som involverade datah√§mtning via ett API och d√§r de olika formul√§r-stegen hade beroenden av state mellan sig.</p>
<h2 id="fas-1-usestate-variabler-everywhere"><a aria-hidden="true" tabindex="-1" href="#fas-1-usestate-variabler-everywhere"><span class="icon icon-link"></span></a>Fas 1: useState-variabler everywhere!</h2>
<p>Jag och en kollega skulle som sagt bygga ett formul√§r som hade flera olika steg. Kortfattad och simplifierat skulle formul√§ret bete sig s√• h√§r:</p>
<ul>
<li><strong>I steg 1:</strong> Inputf√§lt f√∂r att s√∂ka efter data via ett API och l√•t anv√§ndaren v√§lja ett alternativ fr√•n API:et. Beroende p√• vad anv√§ndaren v√§ljer g√•r ett till API-anrop iv√§g och beroende p√• om man f√•r en eller fler tr√§ffar tillbaka l√•t anv√§ndaren v√§lja ett av de alternativen. F√•r man bara en tr√§ff fr√•n det andra API-anropet ska den infon s√§ttas direkt i state ist√§llet f√∂r att anv√§ndaren beh√∂ver v√§lja n√•got.</li>
<li><strong>I steg 2</strong>: Beroende p√• state som s√§tts i steg 1 s√• h√§mtas annan data fr√•n ett API och anv√§ndaren f√•r v√§lja n√•gra alternativ i dropdown-inputs.</li>
<li><strong>I steg 3</strong>: Anv√§ndaren granskar den data som hen angett i steg 1 och 2.</li>
</ul>
<p>Anv√§ndaren har √§ven m√∂jlighet att backa ett steg i taget i formul√§ret och eftersom att steg 2 beror p√• data som valts i steg 1 s√• skulle all state rensas i steg 1.</p>
<p>N√§r vi b√∂rjade bygga formul√§ret hade vi inte riktigt rett ut exakt alla stadier och nyanser i state:et f√∂r formul√§ret.</p>
<p>Vi b√∂rjade helt enkelt med en <code>const [inputOne, setInputTwo] = useState(‚Äô‚Äô)</code> f√∂r varje liten del av formul√§r-state:t vi kom p√• och byggde successivt upp mer och mer state-variabler och kopplade ihop dessa med <code>onChange()</code> callbacks p√• input-f√§lt och satte data fr√•n API-anrop till state-variablerna.</p>
<p>I takt med att vi utforskade all state-logik och komplexitet som faktiskt fanns i det formul√§r vi h√∂ll p√• att bygga ins√•g vi att det vart r√§tt oh√•llbart att h√•lla reda p√• all state-logik. Detta f√∂r att sm√• bitar av formul√§r-state sattes h√§r och d√§r i callbacks och asynkront efter API-anrop.</p>
<p>Vi b√∂rjade √§ven f√• state-variabler som berodde p√• andra state-variabler och hade sv√•rt att se helheten f√∂r formul√§ret, all dess logik och nyanser av state.</p>
<h2 id="fas-2-gruppera-state-i-ett-objekt"><a aria-hidden="true" tabindex="-1" href="#fas-2-gruppera-state-i-ett-objekt"><span class="icon icon-link"></span></a>Fas 2: Gruppera state i ett objekt</h2>
<p>I ett f√∂rs√∂k att ta lite mer kontroll √∂ver formul√§rets state och f√• b√§ttre √∂verblick s√• flyttade vi in alla individuella bitar av state till ett enda objekt ist√§llet.</p>
<p>Att gruppera allt i ett objekt hj√§lpte till avsev√§rt med √∂verblicken av formul√§r-datat. Mycket f√∂r att vi skrev TypeScript-kod och typade upp ett interface f√∂r hela formul√§rets state.</p>
<p>Vi slapp √§ven flera individuella <code>setState()</code> anrop f√∂r flera sub-v√§rden i state:t. Vi gick fr√•n s√•nt h√§r:</p>
<pre class="language-js"><code class="language-js code-highlight"><span class="code-line line-number" line="1"><span class="token keyword">const</span> <span class="token function-variable function">onInputChange</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="2">  <span class="token function">setInputOne</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="3">  <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token keyword control-flow">await</span> <span class="token function">fetchFromAPI</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="4">  <span class="token function">setDataOne</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="5"><span class="token punctuation">}</span><span class="token punctuation">;</span>
</span></code></pre>
<p>Till att ist√§llet skriva s√•nt h√§r:</p>
<pre class="language-js"><code class="language-js code-highlight"><span class="code-line line-number" line="1"><span class="token keyword">const</span> <span class="token function-variable function">onInputChange</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="2">  <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token keyword control-flow">await</span> <span class="token function">fetchFromAPI</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="3">  <span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token spread operator">...</span>state<span class="token punctuation">,</span> <span class="token literal-property property">inputOne</span><span class="token operator">:</span> value<span class="token punctuation">,</span> <span class="token literal-property property">dataOne</span><span class="token operator">:</span> data <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="4"><span class="token punctuation">}</span><span class="token punctuation">;</span>
</span></code></pre>
<p>Perfekt. Vi hade nu allts√• b√§ttre koll p√• hur formul√§rets state s√•g ut f√∂r att allt var grupperat.</p>
<p>N√•got vi fortfarande hade problem med var att vi i <strong>formul√§r-komponenten beh√∂vde ha stenkoll p√• beroenden mellan sub-v√§rden i state-objektet</strong>.</p>
<p>Ett konkret exempel p√• detta √§r att vi allt eftersom uppt√§ckte att vi beh√∂vde lite custom input-valideringsfeedback i formul√§rets olika steg innan man kunde g√• vidare till n√§sta steg. S√•n feedback ritades ut i alerts direkt i formul√§ret och feedback-texterna sattes i state-objektet som en array med str√§ngar.</p>
<p>Om anv√§ndaren d√• f√∂rs√∂kte g√• vidare till n√§sta steg i formul√§ret fick denne feedback om att viss input-data saknades. N√§r anv√§ndaren d√• b√∂rjade fylla i den datan skulle feedbacken f√∂rsvinna. Vi b√∂rjade f√• s√•dana h√§r exempel lite h√§r och var i koden:</p>
<pre class="language-js"><code class="language-js code-highlight"><span class="code-line line-number" line="1"><span class="token keyword">const</span> <span class="token function-variable function">onInputChange</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="2">  <span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token spread operator">...</span>state<span class="token punctuation">,</span> <span class="token literal-property property">inputOne</span><span class="token operator">:</span> value<span class="token punctuation">,</span> <span class="token literal-property property">feedback</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="3"><span class="token punctuation">}</span><span class="token punctuation">;</span>
</span></code></pre>
<p>Ett annat exempel p√• beroenden mellan sub-v√§rden √§r att det kunde uppst√• scenarion d√• anv√§ndaren inte ens skulle kunna g√• vidare fr√•n steg 1 till steg 2, beroende p√• den data man fick tillbaka fr√•n API:et i steg 1. Detta styrde vi med boolean-flaggor i state-objektet som sattes till true eller false beroende p√• svarsdatat fr√•n API:et.</p>
<p>Ett tredje exempel √§r att all state skulle rensas n√§r anv√§ndarn gick tillbaka till steg 1 i formul√§ret. Vi hade en generell funktion som tog in ett givet steg som en parameter och satte den parametern i state-objektet. N√§r inparametern dock var <code>0</code>, vilket representerade steg 1, s√• skulle hela state:t t√∂mmas.</p>
<p>Komplexiteten och alla nyanser i state:t beh√∂vde dels vi som utvecklare av formul√§ret, men √§ven formul√§ret i sig ha stenkoll p√•. I en del l√§gen skulle man s√§tta men ocks√• rensa sub-v√§rden i state:t och i andra l√§gen skulle man tolka data som skulle s√§ttas i tv√• sub-state v√§rden p√• tv√• olika s√§tt.</p>
<p><strong>Det √§r i det h√§r l√§get som vi b√∂rjade snegla p√• att anv√§nda useReducer ist√§llet.</strong></p>
<h2 id="fas-3-kasta-ut-usestate-och-v√§lkomna-usereducer"><a aria-hidden="true" tabindex="-1" href="#fas-3-kasta-ut-usestate-och-v√§lkomna-usereducer"><span class="icon icon-link"></span></a>Fas 3: Kasta ut useState och v√§lkomna useReducer</h2>
<p>Den korta beskrivningen en bit upp i denna text som beskriver de l√§gen som useReducer √§r att rekommendera √∂ver useState ang√•ende komplex state-logik och sub-v√§rden √§r v√§ldigt talande f√∂r de f√∂rdelar vi snabbt s√•g efter att vi hade refaktorerat formul√§rets state till en useReducer ist√§llet.</p>
<p>Att vi b√∂rjade snegla mot useReducer b√∂rjade v√§l med att vi i princip hade all state-logik p√• plats och formul√§ret i sin helhet fungerade enligt kravspec, med v√•rat state-objekt.</p>
<p>Men n√§r vi kikade igenom koden k√§ndes det fortfarande som att det var v√§ldigt m√•nga olika callbacks osv d√§r state sattes och vi hade fortfarande kvar alla beroenden mellan sub-v√§rden.</p>
<p>Formul√§r-komponenten var helt enkelt sv√•r att h√§nga med i d√• det sattes state lite h√§r och d√§r och vi beh√∂vde ha stenkoll p√• i vilka callbacks som validerings-feedback skulle rensas osv.</p>
<p>Formul√§ret i sig beh√∂vde √§ven ha koll p√• att n√§r anv√§ndaren klickar sig bak√•t mellan stegen s√• ska hela state-objektet rensas om anv√§ndaren klickade sig tillbaka till f√∂rsta steget.</p>
<h3 id="vad-g√∂r-usereducer"><a aria-hidden="true" tabindex="-1" href="#vad-g√∂r-usereducer"><span class="icon icon-link"></span></a>Vad g√∂r useReducer?</h3>
<p>Vad √§r det d√• som skiljer useState fr√•n useReducer? useReducer fungerar lite mer som Redux i det s√§tt att useReducer-hooken ger tillbaka <code>state</code> och en <code>dispatch</code> funktion. Via dispatch skickar man olika ‚Äùactions‚Äù med eller utan data f√∂r att uppdatera state, via en reducer-funktion:</p>
<pre class="language-js"><code class="language-js code-highlight"><span class="code-line"><span class="token keyword">const</span> <span class="token punctuation">[</span>state<span class="token punctuation">,</span> dispatch<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useReducer</span><span class="token punctuation">(</span>reducer<span class="token punctuation">,</span> initialState<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></code></pre>
<p>Reducer-funktionen i sin tur tar state:ta nuvarande version och en action som parametrar och vanligtvis (precis som med Redux) s√• brukar reducern best√• av en switch/case p√• <code>action.type</code> d√§r olika action-types uppdaterar state p√• lite olika s√§tt.</p>
<blockquote>
<p>Vill man veta mer om useReducer s√• √§r den <a href="https://reactjs.org/docs/hooks-reference.html">officiella dokumentationen</a> en bra startpunkt.</p>
</blockquote>
<p>F√∂r den komponent som ska uppdatera state handlar det f√∂renklat om att man g√•r fr√•n <code>setState({ ...state, inputOne: value})</code> till <code>dispatch({ type: ‚ÄôINPUT_ONE‚Äô, value })</code>.</p>
<h3 id="vilka-f√∂rdelar-s√•g-vi"><a aria-hidden="true" tabindex="-1" href="#vilka-f√∂rdelar-s√•g-vi"><span class="icon icon-link"></span></a>Vilka f√∂rdelar s√•g vi?</h3>
<p>Vilka f√∂rdelar kunde vi d√• se n√§r vi refaktorerade fr√•n l√∂sningen med useState och v√•rat state-objekt till att anv√§nda useReducer ist√§llet?</p>
<p>Den allra st√∂rsta f√∂rdelen vi s√•g var att formul√§r-komponenten nu bara beh√∂vde fokusera p√• <strong>vad</strong> som skulle h√§nda och inte exakt <strong>hur</strong> n√•got skulle h√§nda. Om man ska ta exemplet med att l√•ta anv√§ndaren backa i formul√§ret s√• gick vi fr√•n (ungef√§r):</p>
<pre class="language-js"><code class="language-js code-highlight"><span class="code-line line-number" line="1"><span class="token keyword">const</span> <span class="token function-variable function">onStepChange</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">step</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="2">  <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>step <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="3">    <span class="token function">setState</span><span class="token punctuation">(</span>emptyFormData<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="4">    <span class="token keyword control-flow">return</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="5">  <span class="token punctuation">}</span>
</span><span class="code-line line-number" line="6">  <span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token spread operator">...</span>state<span class="token punctuation">,</span> <span class="token literal-property property">step</span><span class="token operator">:</span> step <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="7"><span class="token punctuation">}</span><span class="token punctuation">;</span>
</span></code></pre>
<p>Till en l√∂sning d√§r formul√§ret inte beh√∂vde bry sig om s√•dana detaljer:</p>
<pre class="language-js"><code class="language-js code-highlight"><span class="code-line line-number" line="1"><span class="token keyword">const</span> <span class="token function-variable function">onStepChange</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">step</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="2">	<span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">type</span><span class="token operator">:</span> ‚Äô<span class="token constant">FORM_STEP</span>‚Äô<span class="token punctuation">,</span> <span class="token literal-property property">step</span><span class="token operator">:</span> step <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="3"><span class="token punctuation">}</span>
</span></code></pre>
<p>V√•r formul√§r-reducer s√•g d√• till att sj√§lv antingen bara backa ett steg eller rensa hela formul√§ret i sin helhet, d√• anv√§ndaren backade till f√∂rsta steget.</p>
<p>En annan f√∂rdel vi s√•g var att formul√§ret inte l√§ngre beh√∂vde bry sig om att i vissa l√§gen rensa den validerings-feedback array som fanns i state. S√•dana detaljer var upp till reducern att sk√∂ta, beroende p√• vilken action som formul√§ret dispatchade.</p>
<p>En tredje f√∂rdel var att formul√§ret nu inte l√§ngre beh√∂vde bry sig alls om eventuella beroenden mellan sub-v√§rden i state:t. Formul√§ret dispatchade bara sina actions med tillh√∂rande data och reducern s√•g till att s√§tta eventuella boolean-flaggor osv sj√§lv.</p>
<h3 id="mer-boilerplate-kod-men-kontrollerade-state-f√∂r√§ndringar"><a aria-hidden="true" tabindex="-1" href="#mer-boilerplate-kod-men-kontrollerade-state-f√∂r√§ndringar"><span class="icon icon-link"></span></a>Mer boilerplate-kod men kontrollerade state-f√∂r√§ndringar</h3>
<p>Visserligen innebar useReducern lite mer ‚Äùboilerplate-kod‚Äù, framf√∂r allt d√• vi jobbar med TypeScript och typade upp alla action-typen och payloads som man kunde skicka in i reducern. Men detta innebar ju ocks√• att vi fick ett tydligare kontrakt mellan formul√§ret och reducern, och hur formul√§ret kunde p√•verka state:t p√• ett v√§ligt kontrollerat s√§tt.</p>
<p>All boilerplate gjorde det tydligt att vi kunde lyfta ut useReducern till en custom hook. D√• vi gjorde detta blev dessutom formul√§r-komponenten 100% mer √∂versk√•dlig. Nu ansvarade formul√§r-komponenten i princip bara f√∂r att h√§mta data fr√•n API:er i vissa funktioner och dispatcha actions, samt dispatcha vissa actions direkt i ‚ÄùonInputChange-funktioner‚Äù.</p>
<p>All faktiskt state-hantering lyftes ut till en separat fil. Beh√∂vde vi se hur state:t s√•g ut eller hur det skulle f√∂r√§ndras √∂ver tid gav reducern oss en tydligare √∂verblick, ist√§llet f√∂r att beh√∂va skrolla runt i formul√§r-komponenten och jaga <code>setState</code> anrop.</p>
<h2 id="summering"><a aria-hidden="true" tabindex="-1" href="#summering"><span class="icon icon-link"></span></a>Summering</h2>
<p>Phew! D√§r var vi i m√•l!</p>
<p>Vad kan man d√• dra f√∂r summerande slutsatser av det hela? Ska man strunta i useState helt och ist√§llet anv√§nda useReducer? Absolut inte! Hook:en useState √§r v√§ldigt bra om man har ett state som inte √§r speciellt komplext. Att alltid anv√§nda useReducer skulle f√∂rmodligen inneb√§ra on√∂digt komplex l√∂sning f√∂r en icke-komplex utmaning.</p>
<p>Men √• andra sidan tror jag inte man ska vara r√§dd f√∂r att byta ut useState mot useReducer i de l√§gen en komponents state v√§xer. Personligen tyckte jag att useReducer s√•g ut som on√∂digt avancerat s√§tt att hantera state i funktions-komponenter innan jag testade p√• den, men s√•g genast f√∂rdelar med den n√§r jag v√§l b√∂rjade anv√§nda den.</p>
<p>Har man lite mer avancerat state och synkar inte bara input-f√§lt till data eller t√§nder och sl√§cker grejer rent visuellt med boolean-flaggor √§r useReducer ett v√§ldigt bra alternativ f√∂r att f√• b√§ttre kontroll √∂ver state och state-f√∂r√§ndringar.</p>
<blockquote>
<p>V√§rt att p√•peka √§r ju att det h√§r √§r tankar och funderingar efter att ha anv√§nt useReducer <em>en</em> g√•ng. Men jag k√§nde √§nd√• f√∂r att f√• nedskrivet n√•gra reflektioner.</p>
</blockquote>
<p>N√§sta g√•ng jag st√•r inf√∂r lite mer avancerad state kommer jag i alla fall inte tveka att √∂verv√§ga useReducer som l√∂sning ist√§llet f√∂r useState, d√• man har mycket att vinna p√• det!</p><div class="c-dhzjXW c-dhzjXW-oSmJK-size-large"></div><div class="c-bPgfrJ"></div><div class="c-dhzjXW c-dhzjXW-AlumW-size-medium"></div><h2>Mer inneh√•ll</h2><div class="c-bQzyIt c-bQzyIt-ikUNLjE-css"><div class="PJLV c-bImmwG PJLV-igsmDXe-css"><a href="/blogg/media-queries-a-la-styled-components" class="c-jyhawZ"><div class="c-bZNrxE c-bZNrxE-ilkBNdM-css"><div class="c-dhzjXW c-dhzjXW-fmMVkQ-size-small"></div><div class="c-fixGjY c-fixGjY-iirEjuD-css"><div class="c-dhzjXW c-dhzjXW-fmMVkQ-size-small"></div><p class="c-jNUAyN c-jNUAyN-ihtBelh-css">‚Üê F√∂reg√•ende</p><h3 class="c-PJLV c-PJLV-idFXbZW-css">Media Queries √° la styled-components</h3><p class="c-jNUAyN">2020-11-01</p></div><div class="c-dhzjXW c-dhzjXW-fmMVkQ-size-small"></div></div></a></div><div class="PJLV c-bImmwG PJLV-igsmDXe-css"><a href="/blogg/hur-aftonbladet-pajade-min-sajt-och-varfor-det-ar-okej-att-lata-det-ligga-i-backloggen-tillsvidare" class="c-jyhawZ"><div class="c-bZNrxE c-bZNrxE-ilkBNdM-css"><div class="c-dhzjXW c-dhzjXW-fmMVkQ-size-small"></div><div class="c-fixGjY c-fixGjY-iirEjuD-css"><div class="c-dhzjXW c-dhzjXW-fmMVkQ-size-small"></div><p class="c-jNUAyN c-jNUAyN-ihtBelh-css">N√§sta ‚Üí</p><h3 class="c-PJLV c-PJLV-idFXbZW-css">Hur Aftonbladet pajade min sajt och varf√∂r det √§r okej att l√•ta det ligga i backloggen tillsvidare</h3><p class="c-jNUAyN">2021-07-09</p></div><div class="c-dhzjXW c-dhzjXW-fmMVkQ-size-small"></div></div></a></div></div></div></div></div></div></div><div class="c-dhzjXW c-dhzjXW-oSmJK-size-large"></div><div class="c-bFBiOr"><div class="c-bkUlwM"><div class="c-fixGjY"><div class="c-dhzjXW c-dhzjXW-AlumW-size-medium"></div><div class="c-bZNrxE"><p class="c-jKTQyv">Daniel Vernberg <!-- -->2023</p><div class="c-cZmHrB"></div><a href="https://github.com/danielv14"><div class="PJLV PJLV-idhzjXW-css"><svg viewBox="0 0 24 24" height="24px" width="24px" class="PJLV PJLV-ieKjzkc-css"><path d="M16.24 22a1 1 0 01-1-1v-2.6a2.15 2.15 0 00-.54-1.66 1 1 0 01.61-1.67C17.75 14.78 20 14 20 9.77a4 4 0 00-.67-2.22 2.75 2.75 0 01-.41-2.06 3.71 3.71 0 000-1.41 7.65 7.65 0 00-2.09 1.09 1 1 0 01-.84.15 10.15 10.15 0 00-5.52 0 1 1 0 01-.84-.15 7.4 7.4 0 00-2.11-1.09 3.52 3.52 0 000 1.41 2.84 2.84 0 01-.43 2.08 4.07 4.07 0 00-.67 2.23c0 3.89 1.88 4.93 4.7 5.29a1 1 0 01.82.66 1 1 0 01-.21 1 2.06 2.06 0 00-.55 1.56V21a1 1 0 01-2 0v-.57a6 6 0 01-5.27-2.09 3.9 3.9 0 00-1.16-.88 1 1 0 11.5-1.94 4.93 4.93 0 012 1.36c1 1 2 1.88 3.9 1.52a3.89 3.89 0 01.23-1.58c-2.06-.52-5-2-5-7a6 6 0 011-3.33.85.85 0 00.13-.62 5.69 5.69 0 01.33-3.21 1 1 0 01.63-.57c.34-.1 1.56-.3 3.87 1.2a12.16 12.16 0 015.69 0c2.31-1.5 3.53-1.31 3.86-1.2a1 1 0 01.63.57 5.71 5.71 0 01.33 3.22.75.75 0 00.11.57 6 6 0 011 3.34c0 5.07-2.92 6.54-5 7a4.28 4.28 0 01.22 1.67V21a1 1 0 01-.94 1z" data-name="github"></path></svg></div></a><div class="c-dhzjXW c-dhzjXW-fmMVkQ-size-small"></div><a href="mailto:daniel.vernberg@gmail.com"><div class="PJLV PJLV-idhzjXW-css"><svg viewBox="0 0 24 24" height="24px" width="24px" class="PJLV PJLV-ieKjzkc-css"><path d="M19 4H5a3 3 0 00-3 3v10a3 3 0 003 3h14a3 3 0 003-3V7a3 3 0 00-3-3zm-.67 2L12 10.75 5.67 6zM19 18H5a1 1 0 01-1-1V7.25l7.4 5.55a1 1 0 00.6.2 1 1 0 00.6-.2L20 7.25V17a1 1 0 01-1 1z" data-name="email"></path></svg></div></a></div><div class="c-dhzjXW c-dhzjXW-AlumW-size-medium"></div></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"title":"N√§r man f√∂rmodligen vill byta ut useState mot useReducer","date":"2021-02-13T00:00:00.000Z","summary":"Hook:en useState √§r bra till mycket. Men ibland r√§cker inte den inte hela v√§gen. Det h√§r √§r lite reflektioner √∂ver f√∂rsta g√•ngen jag anv√§nde useReducer f√∂r att l√∂sa lite mer avancerad state.","body":{"raw":"\nDet h√§r √§r en genomg√•ng och reflektioner av hur det gick till n√§r jag f√∂r f√∂rsta g√•ngen anv√§nde useReducer som ett rimligare alternativ till useState, p√• grund av ett multi-steg-formul√§rs komplexitet.\n\n## Kort om useState\n\nReact-hook:en `useState` √§r v√§ldigt smidig att anv√§nda n√§r man vill g√∂ra en funktionskomponent stateful. Det √§r relativt l√§tt att h√§mta lite data asynkront fr√•n ett API och s√§tta det i state, eller koppla ihop inputf√§ltv√§rden med state.\n\nEn uppenbar skillnad mellan useState och hur man ofta skriver och s√§tter state i klasskomponenter √§r att man via useState kan ha flera ‚Äùstate-variabler‚Äù, medan man i en klass-komponent jobbar med state som ett objekt.\n\nS√§g att man har ett formul√§r och vill anv√§nda useState f√∂r state-hantering med 3-4 inputf√§lt. Det enklaste √§r nog att ha separata state-variabler f√∂r varje inputf√§lt, ungef√§r s√• h√§r:\n\n```ts showLineNumbers\nconst [inputOne, setInputOne] = useState(‚Äô‚Äô);\nconst [inputTwo, setInputTwo] = useState(‚Äô‚Äô);\nconst [inputThree, setInputThree] = useState(‚Äô‚Äô);\nconst [inputFour, setInputFour] = useState(‚Äô‚Äô);\n```\n\nAtt separera state f√∂r ett formul√§r p√• det h√§r s√§ttet kanske √§r det mest uppenbara tillv√§gag√•ngss√§ttet. Ett alternativ f√∂r n√§r ett formul√§r, eller vilken sorts komponent som helst egentligen som beh√∂ver state, inte √§r speciellt komplext och n√§r det inte finns s√• m√•nga ‚Äùnyanser‚Äù i hur state:t kan se ut.\n\nN√§r man d√• ist√§llet beh√∂ver lite komplexare state-hantering kan det kanske ses naturligt att gruppera state i ett objekt ist√§llet, likt state f√∂r en klass-komponent. Detta kan framf√∂r allt vara bra f√∂r att man f√•r en b√§ttre √∂verblick √∂ver hur en komponents state ser ut, ist√§llet f√∂r att man har v√§ldigt m√•nga individuella `const [state, setState] = useState()` att h√•lla reda p√•.\n\n√ñversk√•dligheten blir om √§nnu b√§ttre om man anv√§nder TypeScript och kan typa upp sitt useState objekt.\n\n### N√§r useState inte r√§cker till\n\nR√§cker det d√• att forts√§tta anv√§nda useState tillsammans med ett objekt ist√§llet och l√•ta formul√§ret/funktionskomponent sk√∂ta lite komplexare state-logik? Inte riktigt. Den officiella dokumentationen f√∂r React [rekommenderar](https://reactjs.org/docs/hooks-reference.html) att man ist√§llet ska anv√§nda hook:en `useReducer`, med motiveringen:\n\n\u003e **useReducer** is usually preferable to **useState** when you have complex state logic that involves multiple sub-values or when the next state depends on the previous one\n\nFlera individuella useState-variabler, ett enda state-objekt och sen useReducer. Det √§r i stora drag de tre olika stadier som jag och en kollega gick igenom n√§r vi f√∂r ett tag sedan i ett projekt skulle bygga ett multi-stegs formul√§r. Ett formul√§r som involverade datah√§mtning via ett API och d√§r de olika formul√§r-stegen hade beroenden av state mellan sig.\n\n## Fas 1: useState-variabler everywhere!\n\nJag och en kollega skulle som sagt bygga ett formul√§r som hade flera olika steg. Kortfattad och simplifierat skulle formul√§ret bete sig s√• h√§r:\n\n- **I steg 1:** Inputf√§lt f√∂r att s√∂ka efter data via ett API och l√•t anv√§ndaren v√§lja ett alternativ fr√•n API:et. Beroende p√• vad anv√§ndaren v√§ljer g√•r ett till API-anrop iv√§g och beroende p√• om man f√•r en eller fler tr√§ffar tillbaka l√•t anv√§ndaren v√§lja ett av de alternativen. F√•r man bara en tr√§ff fr√•n det andra API-anropet ska den infon s√§ttas direkt i state ist√§llet f√∂r att anv√§ndaren beh√∂ver v√§lja n√•got.\n- **I steg 2**: Beroende p√• state som s√§tts i steg 1 s√• h√§mtas annan data fr√•n ett API och anv√§ndaren f√•r v√§lja n√•gra alternativ i dropdown-inputs.\n- **I steg 3**: Anv√§ndaren granskar den data som hen angett i steg 1 och 2.\n\nAnv√§ndaren har √§ven m√∂jlighet att backa ett steg i taget i formul√§ret och eftersom att steg 2 beror p√• data som valts i steg 1 s√• skulle all state rensas i steg 1.\n\nN√§r vi b√∂rjade bygga formul√§ret hade vi inte riktigt rett ut exakt alla stadier och nyanser i state:et f√∂r formul√§ret.\n\nVi b√∂rjade helt enkelt med en `const [inputOne, setInputTwo] = useState(‚Äô‚Äô)` f√∂r varje liten del av formul√§r-state:t vi kom p√• och byggde successivt upp mer och mer state-variabler och kopplade ihop dessa med `onChange()` callbacks p√• input-f√§lt och satte data fr√•n API-anrop till state-variablerna.\n\nI takt med att vi utforskade all state-logik och komplexitet som faktiskt fanns i det formul√§r vi h√∂ll p√• att bygga ins√•g vi att det vart r√§tt oh√•llbart att h√•lla reda p√• all state-logik. Detta f√∂r att sm√• bitar av formul√§r-state sattes h√§r och d√§r i callbacks och asynkront efter API-anrop.\n\nVi b√∂rjade √§ven f√• state-variabler som berodde p√• andra state-variabler och hade sv√•rt att se helheten f√∂r formul√§ret, all dess logik och nyanser av state.\n\n## Fas 2: Gruppera state i ett objekt\n\nI ett f√∂rs√∂k att ta lite mer kontroll √∂ver formul√§rets state och f√• b√§ttre √∂verblick s√• flyttade vi in alla individuella bitar av state till ett enda objekt ist√§llet.\n\nAtt gruppera allt i ett objekt hj√§lpte till avsev√§rt med √∂verblicken av formul√§r-datat. Mycket f√∂r att vi skrev TypeScript-kod och typade upp ett interface f√∂r hela formul√§rets state.\n\nVi slapp √§ven flera individuella `setState()` anrop f√∂r flera sub-v√§rden i state:t. Vi gick fr√•n s√•nt h√§r:\n\n```js showLineNumbers\nconst onInputChange = async (value) =\u003e {\n  setInputOne(value);\n  const data = await fetchFromAPI(value);\n  setDataOne(data);\n};\n```\n\nTill att ist√§llet skriva s√•nt h√§r:\n\n```js showLineNumbers\nconst onInputChange = async (value) =\u003e {\n  const data = await fetchFromAPI(value);\n  setState({ ...state, inputOne: value, dataOne: data });\n};\n```\n\nPerfekt. Vi hade nu allts√• b√§ttre koll p√• hur formul√§rets state s√•g ut f√∂r att allt var grupperat.\n\nN√•got vi fortfarande hade problem med var att vi i **formul√§r-komponenten beh√∂vde ha stenkoll p√• beroenden mellan sub-v√§rden i state-objektet**.\n\nEtt konkret exempel p√• detta √§r att vi allt eftersom uppt√§ckte att vi beh√∂vde lite custom input-valideringsfeedback i formul√§rets olika steg innan man kunde g√• vidare till n√§sta steg. S√•n feedback ritades ut i alerts direkt i formul√§ret och feedback-texterna sattes i state-objektet som en array med str√§ngar.\n\nOm anv√§ndaren d√• f√∂rs√∂kte g√• vidare till n√§sta steg i formul√§ret fick denne feedback om att viss input-data saknades. N√§r anv√§ndaren d√• b√∂rjade fylla i den datan skulle feedbacken f√∂rsvinna. Vi b√∂rjade f√• s√•dana h√§r exempel lite h√§r och var i koden:\n\n```js showLineNumbers\nconst onInputChange = (value) =\u003e {\n  setState({ ...state, inputOne: value, feedback: [] });\n};\n```\n\nEtt annat exempel p√• beroenden mellan sub-v√§rden √§r att det kunde uppst√• scenarion d√• anv√§ndaren inte ens skulle kunna g√• vidare fr√•n steg 1 till steg 2, beroende p√• den data man fick tillbaka fr√•n API:et i steg 1. Detta styrde vi med boolean-flaggor i state-objektet som sattes till true eller false beroende p√• svarsdatat fr√•n API:et.\n\nEtt tredje exempel √§r att all state skulle rensas n√§r anv√§ndarn gick tillbaka till steg 1 i formul√§ret. Vi hade en generell funktion som tog in ett givet steg som en parameter och satte den parametern i state-objektet. N√§r inparametern dock var `0`, vilket representerade steg 1, s√• skulle hela state:t t√∂mmas.\n\nKomplexiteten och alla nyanser i state:t beh√∂vde dels vi som utvecklare av formul√§ret, men √§ven formul√§ret i sig ha stenkoll p√•. I en del l√§gen skulle man s√§tta men ocks√• rensa sub-v√§rden i state:t och i andra l√§gen skulle man tolka data som skulle s√§ttas i tv√• sub-state v√§rden p√• tv√• olika s√§tt.\n\n**Det √§r i det h√§r l√§get som vi b√∂rjade snegla p√• att anv√§nda useReducer ist√§llet.**\n\n## Fas 3: Kasta ut useState och v√§lkomna useReducer\n\nDen korta beskrivningen en bit upp i denna text som beskriver de l√§gen som useReducer √§r att rekommendera √∂ver useState ang√•ende komplex state-logik och sub-v√§rden √§r v√§ldigt talande f√∂r de f√∂rdelar vi snabbt s√•g efter att vi hade refaktorerat formul√§rets state till en useReducer ist√§llet.\n\nAtt vi b√∂rjade snegla mot useReducer b√∂rjade v√§l med att vi i princip hade all state-logik p√• plats och formul√§ret i sin helhet fungerade enligt kravspec, med v√•rat state-objekt.\n\nMen n√§r vi kikade igenom koden k√§ndes det fortfarande som att det var v√§ldigt m√•nga olika callbacks osv d√§r state sattes och vi hade fortfarande kvar alla beroenden mellan sub-v√§rden.\n\nFormul√§r-komponenten var helt enkelt sv√•r att h√§nga med i d√• det sattes state lite h√§r och d√§r och vi beh√∂vde ha stenkoll p√• i vilka callbacks som validerings-feedback skulle rensas osv.\n\nFormul√§ret i sig beh√∂vde √§ven ha koll p√• att n√§r anv√§ndaren klickar sig bak√•t mellan stegen s√• ska hela state-objektet rensas om anv√§ndaren klickade sig tillbaka till f√∂rsta steget.\n\n### Vad g√∂r useReducer?\n\nVad √§r det d√• som skiljer useState fr√•n useReducer? useReducer fungerar lite mer som Redux i det s√§tt att useReducer-hooken ger tillbaka `state` och en `dispatch` funktion. Via dispatch skickar man olika ‚Äùactions‚Äù med eller utan data f√∂r att uppdatera state, via en reducer-funktion:\n\n```js\nconst [state, dispatch] = useReducer(reducer, initialState);\n```\n\nReducer-funktionen i sin tur tar state:ta nuvarande version och en action som parametrar och vanligtvis (precis som med Redux) s√• brukar reducern best√• av en switch/case p√• `action.type` d√§r olika action-types uppdaterar state p√• lite olika s√§tt.\n\n\u003e Vill man veta mer om useReducer s√• √§r den [officiella dokumentationen](https://reactjs.org/docs/hooks-reference.html) en bra startpunkt.\n\nF√∂r den komponent som ska uppdatera state handlar det f√∂renklat om att man g√•r fr√•n `setState({ ...state, inputOne: value})` till `dispatch({ type: ‚ÄôINPUT_ONE‚Äô, value })`.\n\n### Vilka f√∂rdelar s√•g vi?\n\nVilka f√∂rdelar kunde vi d√• se n√§r vi refaktorerade fr√•n l√∂sningen med useState och v√•rat state-objekt till att anv√§nda useReducer ist√§llet?\n\nDen allra st√∂rsta f√∂rdelen vi s√•g var att formul√§r-komponenten nu bara beh√∂vde fokusera p√• **vad** som skulle h√§nda och inte exakt **hur** n√•got skulle h√§nda. Om man ska ta exemplet med att l√•ta anv√§ndaren backa i formul√§ret s√• gick vi fr√•n (ungef√§r):\n\n```js showLineNumbers\nconst onStepChange = (step) =\u003e {\n  if (step === 0) {\n    setState(emptyFormData);\n    return;\n  }\n  setState({ ...state, step: step });\n};\n```\n\nTill en l√∂sning d√§r formul√§ret inte beh√∂vde bry sig om s√•dana detaljer:\n\n```js showLineNumbers\nconst onStepChange = (step) =\u003e {\n\tdispatch({ type: ‚ÄôFORM_STEP‚Äô, step: step });\n}\n```\n\nV√•r formul√§r-reducer s√•g d√• till att sj√§lv antingen bara backa ett steg eller rensa hela formul√§ret i sin helhet, d√• anv√§ndaren backade till f√∂rsta steget.\n\nEn annan f√∂rdel vi s√•g var att formul√§ret inte l√§ngre beh√∂vde bry sig om att i vissa l√§gen rensa den validerings-feedback array som fanns i state. S√•dana detaljer var upp till reducern att sk√∂ta, beroende p√• vilken action som formul√§ret dispatchade.\n\nEn tredje f√∂rdel var att formul√§ret nu inte l√§ngre beh√∂vde bry sig alls om eventuella beroenden mellan sub-v√§rden i state:t. Formul√§ret dispatchade bara sina actions med tillh√∂rande data och reducern s√•g till att s√§tta eventuella boolean-flaggor osv sj√§lv.\n\n### Mer boilerplate-kod men kontrollerade state-f√∂r√§ndringar\n\nVisserligen innebar useReducern lite mer ‚Äùboilerplate-kod‚Äù, framf√∂r allt d√• vi jobbar med TypeScript och typade upp alla action-typen och payloads som man kunde skicka in i reducern. Men detta innebar ju ocks√• att vi fick ett tydligare kontrakt mellan formul√§ret och reducern, och hur formul√§ret kunde p√•verka state:t p√• ett v√§ligt kontrollerat s√§tt.\n\nAll boilerplate gjorde det tydligt att vi kunde lyfta ut useReducern till en custom hook. D√• vi gjorde detta blev dessutom formul√§r-komponenten 100% mer √∂versk√•dlig. Nu ansvarade formul√§r-komponenten i princip bara f√∂r att h√§mta data fr√•n API:er i vissa funktioner och dispatcha actions, samt dispatcha vissa actions direkt i ‚ÄùonInputChange-funktioner‚Äù.\n\nAll faktiskt state-hantering lyftes ut till en separat fil. Beh√∂vde vi se hur state:t s√•g ut eller hur det skulle f√∂r√§ndras √∂ver tid gav reducern oss en tydligare √∂verblick, ist√§llet f√∂r att beh√∂va skrolla runt i formul√§r-komponenten och jaga `setState` anrop.\n\n## Summering\n\nPhew! D√§r var vi i m√•l!\n\nVad kan man d√• dra f√∂r summerande slutsatser av det hela? Ska man strunta i useState helt och ist√§llet anv√§nda useReducer? Absolut inte! Hook:en useState √§r v√§ldigt bra om man har ett state som inte √§r speciellt komplext. Att alltid anv√§nda useReducer skulle f√∂rmodligen inneb√§ra on√∂digt komplex l√∂sning f√∂r en icke-komplex utmaning.\n\nMen √• andra sidan tror jag inte man ska vara r√§dd f√∂r att byta ut useState mot useReducer i de l√§gen en komponents state v√§xer. Personligen tyckte jag att useReducer s√•g ut som on√∂digt avancerat s√§tt att hantera state i funktions-komponenter innan jag testade p√• den, men s√•g genast f√∂rdelar med den n√§r jag v√§l b√∂rjade anv√§nda den.\n\nHar man lite mer avancerat state och synkar inte bara input-f√§lt till data eller t√§nder och sl√§cker grejer rent visuellt med boolean-flaggor √§r useReducer ett v√§ldigt bra alternativ f√∂r att f√• b√§ttre kontroll √∂ver state och state-f√∂r√§ndringar.\n\n\u003e V√§rt att p√•peka √§r ju att det h√§r √§r tankar och funderingar efter att ha anv√§nt useReducer _en_ g√•ng. Men jag k√§nde √§nd√• f√∂r att f√• nedskrivet n√•gra reflektioner.\n\nN√§sta g√•ng jag st√•r inf√∂r lite mer avancerad state kommer jag i alla fall inte tveka att √∂verv√§ga useReducer som l√∂sning ist√§llet f√∂r useState, d√• man har mycket att vinna p√• det!\n","code":"var Component=(()=\u003e{var p=Object.create;var r=Object.defineProperty;var u=Object.getOwnPropertyDescriptor;var h=Object.getOwnPropertyNames;var m=Object.getPrototypeOf,k=Object.prototype.hasOwnProperty;var g=(a,e)=\u003e()=\u003e(e||a((e={exports:{}}).exports,e),e.exports),v=(a,e)=\u003e{for(var t in e)r(a,t,{get:e[t],enumerable:!0})},i=(a,e,t,l)=\u003e{if(e\u0026\u0026typeof e==\"object\"||typeof e==\"function\")for(let s of h(e))!k.call(a,s)\u0026\u0026s!==t\u0026\u0026r(a,s,{get:()=\u003ee[s],enumerable:!(l=u(e,s))||l.enumerable});return a};var f=(a,e,t)=\u003e(t=a!=null?p(m(a)):{},i(e||!a||!a.__esModule?r(t,\"default\",{value:a,enumerable:!0}):t,a)),N=a=\u003ei(r({},\"__esModule\",{value:!0}),a);var o=g((x,c)=\u003e{c.exports=_jsx_runtime});var S={};v(S,{default:()=\u003ej,frontmatter:()=\u003eb});var n=f(o()),b={title:\"N\\xE4r man f\\xF6rmodligen vill byta ut useState mot useReducer\",summary:\"Hook:en useState \\xE4r bra till mycket. Men ibland r\\xE4cker inte den inte hela v\\xE4gen. Det h\\xE4r \\xE4r lite reflektioner \\xF6ver f\\xF6rsta g\\xE5ngen jag anv\\xE4nde useReducer f\\xF6r att l\\xF6sa lite mer avancerad state.\",date:new Date(16131744e5)};function d(a){let e=Object.assign({p:\"p\",h2:\"h2\",a:\"a\",span:\"span\",code:\"code\",pre:\"pre\",h3:\"h3\",blockquote:\"blockquote\",strong:\"strong\",ul:\"ul\",li:\"li\",em:\"em\"},a.components);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(e.p,{children:\"Det h\\xE4r \\xE4r en genomg\\xE5ng och reflektioner av hur det gick till n\\xE4r jag f\\xF6r f\\xF6rsta g\\xE5ngen anv\\xE4nde useReducer som ett rimligare alternativ till useState, p\\xE5 grund av ett multi-steg-formul\\xE4rs komplexitet.\"}),`\n`,(0,n.jsxs)(e.h2,{id:\"kort-om-usestate\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#kort-om-usestate\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Kort om useState\"]}),`\n`,(0,n.jsxs)(e.p,{children:[\"React-hook:en \",(0,n.jsx)(e.code,{children:\"useState\"}),\" \\xE4r v\\xE4ldigt smidig att anv\\xE4nda n\\xE4r man vill g\\xF6ra en funktionskomponent stateful. Det \\xE4r relativt l\\xE4tt att h\\xE4mta lite data asynkront fr\\xE5n ett API och s\\xE4tta det i state, eller koppla ihop inputf\\xE4ltv\\xE4rden med state.\"]}),`\n`,(0,n.jsx)(e.p,{children:\"En uppenbar skillnad mellan useState och hur man ofta skriver och s\\xE4tter state i klasskomponenter \\xE4r att man via useState kan ha flera \\u201Dstate-variabler\\u201D, medan man i en klass-komponent jobbar med state som ett objekt.\"}),`\n`,(0,n.jsx)(e.p,{children:\"S\\xE4g att man har ett formul\\xE4r och vill anv\\xE4nda useState f\\xF6r state-hantering med 3-4 inputf\\xE4lt. Det enklaste \\xE4r nog att ha separata state-variabler f\\xF6r varje inputf\\xE4lt, ungef\\xE4r s\\xE5 h\\xE4r:\"}),`\n`,(0,n.jsx)(e.pre,{className:\"language-ts\",children:(0,n.jsxs)(e.code,{className:\"language-ts code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line line-number\",line:\"1\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"const\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"inputOne\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" setInputOne\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"useState\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"\\u2019\\u2019\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line line-number\",line:\"2\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"const\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"inputTwo\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" setInputTwo\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"useState\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"\\u2019\\u2019\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line line-number\",line:\"3\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"const\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"inputThree\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" setInputThree\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"useState\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"\\u2019\\u2019\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line line-number\",line:\"4\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"const\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"inputFour\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" setInputFour\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"useState\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"\\u2019\\u2019\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]})]})}),`\n`,(0,n.jsx)(e.p,{children:\"Att separera state f\\xF6r ett formul\\xE4r p\\xE5 det h\\xE4r s\\xE4ttet kanske \\xE4r det mest uppenbara tillv\\xE4gag\\xE5ngss\\xE4ttet. Ett alternativ f\\xF6r n\\xE4r ett formul\\xE4r, eller vilken sorts komponent som helst egentligen som beh\\xF6ver state, inte \\xE4r speciellt komplext och n\\xE4r det inte finns s\\xE5 m\\xE5nga \\u201Dnyanser\\u201D i hur state:t kan se ut.\"}),`\n`,(0,n.jsxs)(e.p,{children:[\"N\\xE4r man d\\xE5 ist\\xE4llet beh\\xF6ver lite komplexare state-hantering kan det kanske ses naturligt att gruppera state i ett objekt ist\\xE4llet, likt state f\\xF6r en klass-komponent. Detta kan framf\\xF6r allt vara bra f\\xF6r att man f\\xE5r en b\\xE4ttre \\xF6verblick \\xF6ver hur en komponents state ser ut, ist\\xE4llet f\\xF6r att man har v\\xE4ldigt m\\xE5nga individuella \",(0,n.jsx)(e.code,{children:\"const [state, setState] = useState()\"}),\" att h\\xE5lla reda p\\xE5.\"]}),`\n`,(0,n.jsx)(e.p,{children:\"\\xD6versk\\xE5dligheten blir om \\xE4nnu b\\xE4ttre om man anv\\xE4nder TypeScript och kan typa upp sitt useState objekt.\"}),`\n`,(0,n.jsxs)(e.h3,{id:\"n\\xE4r-usestate-inte-r\\xE4cker-till\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#n\\xE4r-usestate-inte-r\\xE4cker-till\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"N\\xE4r useState inte r\\xE4cker till\"]}),`\n`,(0,n.jsxs)(e.p,{children:[\"R\\xE4cker det d\\xE5 att forts\\xE4tta anv\\xE4nda useState tillsammans med ett objekt ist\\xE4llet och l\\xE5ta formul\\xE4ret/funktionskomponent sk\\xF6ta lite komplexare state-logik? Inte riktigt. Den officiella dokumentationen f\\xF6r React \",(0,n.jsx)(e.a,{href:\"https://reactjs.org/docs/hooks-reference.html\",children:\"rekommenderar\"}),\" att man ist\\xE4llet ska anv\\xE4nda hook:en \",(0,n.jsx)(e.code,{children:\"useReducer\"}),\", med motiveringen:\"]}),`\n`,(0,n.jsxs)(e.blockquote,{children:[`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\"useReducer\"}),\" is usually preferable to \",(0,n.jsx)(e.strong,{children:\"useState\"}),\" when you have complex state logic that involves multiple sub-values or when the next state depends on the previous one\"]}),`\n`]}),`\n`,(0,n.jsx)(e.p,{children:\"Flera individuella useState-variabler, ett enda state-objekt och sen useReducer. Det \\xE4r i stora drag de tre olika stadier som jag och en kollega gick igenom n\\xE4r vi f\\xF6r ett tag sedan i ett projekt skulle bygga ett multi-stegs formul\\xE4r. Ett formul\\xE4r som involverade datah\\xE4mtning via ett API och d\\xE4r de olika formul\\xE4r-stegen hade beroenden av state mellan sig.\"}),`\n`,(0,n.jsxs)(e.h2,{id:\"fas-1-usestate-variabler-everywhere\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#fas-1-usestate-variabler-everywhere\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Fas 1: useState-variabler everywhere!\"]}),`\n`,(0,n.jsx)(e.p,{children:\"Jag och en kollega skulle som sagt bygga ett formul\\xE4r som hade flera olika steg. Kortfattad och simplifierat skulle formul\\xE4ret bete sig s\\xE5 h\\xE4r:\"}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"I steg 1:\"}),\" Inputf\\xE4lt f\\xF6r att s\\xF6ka efter data via ett API och l\\xE5t anv\\xE4ndaren v\\xE4lja ett alternativ fr\\xE5n API:et. Beroende p\\xE5 vad anv\\xE4ndaren v\\xE4ljer g\\xE5r ett till API-anrop iv\\xE4g och beroende p\\xE5 om man f\\xE5r en eller fler tr\\xE4ffar tillbaka l\\xE5t anv\\xE4ndaren v\\xE4lja ett av de alternativen. F\\xE5r man bara en tr\\xE4ff fr\\xE5n det andra API-anropet ska den infon s\\xE4ttas direkt i state ist\\xE4llet f\\xF6r att anv\\xE4ndaren beh\\xF6ver v\\xE4lja n\\xE5got.\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"I steg 2\"}),\": Beroende p\\xE5 state som s\\xE4tts i steg 1 s\\xE5 h\\xE4mtas annan data fr\\xE5n ett API och anv\\xE4ndaren f\\xE5r v\\xE4lja n\\xE5gra alternativ i dropdown-inputs.\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"I steg 3\"}),\": Anv\\xE4ndaren granskar den data som hen angett i steg 1 och 2.\"]}),`\n`]}),`\n`,(0,n.jsx)(e.p,{children:\"Anv\\xE4ndaren har \\xE4ven m\\xF6jlighet att backa ett steg i taget i formul\\xE4ret och eftersom att steg 2 beror p\\xE5 data som valts i steg 1 s\\xE5 skulle all state rensas i steg 1.\"}),`\n`,(0,n.jsx)(e.p,{children:\"N\\xE4r vi b\\xF6rjade bygga formul\\xE4ret hade vi inte riktigt rett ut exakt alla stadier och nyanser i state:et f\\xF6r formul\\xE4ret.\"}),`\n`,(0,n.jsxs)(e.p,{children:[\"Vi b\\xF6rjade helt enkelt med en \",(0,n.jsx)(e.code,{children:\"const [inputOne, setInputTwo] = useState(\\u2019\\u2019)\"}),\" f\\xF6r varje liten del av formul\\xE4r-state:t vi kom p\\xE5 och byggde successivt upp mer och mer state-variabler och kopplade ihop dessa med \",(0,n.jsx)(e.code,{children:\"onChange()\"}),\" callbacks p\\xE5 input-f\\xE4lt och satte data fr\\xE5n API-anrop till state-variablerna.\"]}),`\n`,(0,n.jsx)(e.p,{children:\"I takt med att vi utforskade all state-logik och komplexitet som faktiskt fanns i det formul\\xE4r vi h\\xF6ll p\\xE5 att bygga ins\\xE5g vi att det vart r\\xE4tt oh\\xE5llbart att h\\xE5lla reda p\\xE5 all state-logik. Detta f\\xF6r att sm\\xE5 bitar av formul\\xE4r-state sattes h\\xE4r och d\\xE4r i callbacks och asynkront efter API-anrop.\"}),`\n`,(0,n.jsx)(e.p,{children:\"Vi b\\xF6rjade \\xE4ven f\\xE5 state-variabler som berodde p\\xE5 andra state-variabler och hade sv\\xE5rt att se helheten f\\xF6r formul\\xE4ret, all dess logik och nyanser av state.\"}),`\n`,(0,n.jsxs)(e.h2,{id:\"fas-2-gruppera-state-i-ett-objekt\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#fas-2-gruppera-state-i-ett-objekt\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Fas 2: Gruppera state i ett objekt\"]}),`\n`,(0,n.jsx)(e.p,{children:\"I ett f\\xF6rs\\xF6k att ta lite mer kontroll \\xF6ver formul\\xE4rets state och f\\xE5 b\\xE4ttre \\xF6verblick s\\xE5 flyttade vi in alla individuella bitar av state till ett enda objekt ist\\xE4llet.\"}),`\n`,(0,n.jsx)(e.p,{children:\"Att gruppera allt i ett objekt hj\\xE4lpte till avsev\\xE4rt med \\xF6verblicken av formul\\xE4r-datat. Mycket f\\xF6r att vi skrev TypeScript-kod och typade upp ett interface f\\xF6r hela formul\\xE4rets state.\"}),`\n`,(0,n.jsxs)(e.p,{children:[\"Vi slapp \\xE4ven flera individuella \",(0,n.jsx)(e.code,{children:\"setState()\"}),\" anrop f\\xF6r flera sub-v\\xE4rden i state:t. Vi gick fr\\xE5n s\\xE5nt h\\xE4r:\"]}),`\n`,(0,n.jsx)(e.pre,{className:\"language-js\",children:(0,n.jsxs)(e.code,{className:\"language-js code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line line-number\",line:\"1\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"const\"}),\" \",(0,n.jsx)(e.span,{className:\"token function-variable function\",children:\"onInputChange\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"async\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token parameter\",children:\"value\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token arrow operator\",children:\"=\u003e\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line line-number\",line:\"2\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token function\",children:\"setInputOne\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"value\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line line-number\",line:\"3\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"const\"}),\" data \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword control-flow\",children:\"await\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"fetchFromAPI\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"value\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line line-number\",line:\"4\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token function\",children:\"setDataOne\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"data\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line line-number\",line:\"5\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]})]})}),`\n`,(0,n.jsx)(e.p,{children:\"Till att ist\\xE4llet skriva s\\xE5nt h\\xE4r:\"}),`\n`,(0,n.jsx)(e.pre,{className:\"language-js\",children:(0,n.jsxs)(e.code,{className:\"language-js code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line line-number\",line:\"1\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"const\"}),\" \",(0,n.jsx)(e.span,{className:\"token function-variable function\",children:\"onInputChange\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"async\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token parameter\",children:\"value\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token arrow operator\",children:\"=\u003e\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line line-number\",line:\"2\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"const\"}),\" data \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword control-flow\",children:\"await\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"fetchFromAPI\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"value\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line line-number\",line:\"3\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token function\",children:\"setState\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\" \",(0,n.jsx)(e.span,{className:\"token spread operator\",children:\"...\"}),\"state\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token literal-property property\",children:\"inputOne\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" value\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token literal-property property\",children:\"dataOne\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" data \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line line-number\",line:\"4\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]})]})}),`\n`,(0,n.jsx)(e.p,{children:\"Perfekt. Vi hade nu allts\\xE5 b\\xE4ttre koll p\\xE5 hur formul\\xE4rets state s\\xE5g ut f\\xF6r att allt var grupperat.\"}),`\n`,(0,n.jsxs)(e.p,{children:[\"N\\xE5got vi fortfarande hade problem med var att vi i \",(0,n.jsx)(e.strong,{children:\"formul\\xE4r-komponenten beh\\xF6vde ha stenkoll p\\xE5 beroenden mellan sub-v\\xE4rden i state-objektet\"}),\".\"]}),`\n`,(0,n.jsx)(e.p,{children:\"Ett konkret exempel p\\xE5 detta \\xE4r att vi allt eftersom uppt\\xE4ckte att vi beh\\xF6vde lite custom input-valideringsfeedback i formul\\xE4rets olika steg innan man kunde g\\xE5 vidare till n\\xE4sta steg. S\\xE5n feedback ritades ut i alerts direkt i formul\\xE4ret och feedback-texterna sattes i state-objektet som en array med str\\xE4ngar.\"}),`\n`,(0,n.jsx)(e.p,{children:\"Om anv\\xE4ndaren d\\xE5 f\\xF6rs\\xF6kte g\\xE5 vidare till n\\xE4sta steg i formul\\xE4ret fick denne feedback om att viss input-data saknades. N\\xE4r anv\\xE4ndaren d\\xE5 b\\xF6rjade fylla i den datan skulle feedbacken f\\xF6rsvinna. Vi b\\xF6rjade f\\xE5 s\\xE5dana h\\xE4r exempel lite h\\xE4r och var i koden:\"}),`\n`,(0,n.jsx)(e.pre,{className:\"language-js\",children:(0,n.jsxs)(e.code,{className:\"language-js code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line line-number\",line:\"1\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"const\"}),\" \",(0,n.jsx)(e.span,{className:\"token function-variable function\",children:\"onInputChange\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token parameter\",children:\"value\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token arrow operator\",children:\"=\u003e\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line line-number\",line:\"2\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token function\",children:\"setState\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\" \",(0,n.jsx)(e.span,{className:\"token spread operator\",children:\"...\"}),\"state\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token literal-property property\",children:\"inputOne\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" value\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token literal-property property\",children:\"feedback\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line line-number\",line:\"3\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]})]})}),`\n`,(0,n.jsx)(e.p,{children:\"Ett annat exempel p\\xE5 beroenden mellan sub-v\\xE4rden \\xE4r att det kunde uppst\\xE5 scenarion d\\xE5 anv\\xE4ndaren inte ens skulle kunna g\\xE5 vidare fr\\xE5n steg 1 till steg 2, beroende p\\xE5 den data man fick tillbaka fr\\xE5n API:et i steg 1. Detta styrde vi med boolean-flaggor i state-objektet som sattes till true eller false beroende p\\xE5 svarsdatat fr\\xE5n API:et.\"}),`\n`,(0,n.jsxs)(e.p,{children:[\"Ett tredje exempel \\xE4r att all state skulle rensas n\\xE4r anv\\xE4ndarn gick tillbaka till steg 1 i formul\\xE4ret. Vi hade en generell funktion som tog in ett givet steg som en parameter och satte den parametern i state-objektet. N\\xE4r inparametern dock var \",(0,n.jsx)(e.code,{children:\"0\"}),\", vilket representerade steg 1, s\\xE5 skulle hela state:t t\\xF6mmas.\"]}),`\n`,(0,n.jsx)(e.p,{children:\"Komplexiteten och alla nyanser i state:t beh\\xF6vde dels vi som utvecklare av formul\\xE4ret, men \\xE4ven formul\\xE4ret i sig ha stenkoll p\\xE5. I en del l\\xE4gen skulle man s\\xE4tta men ocks\\xE5 rensa sub-v\\xE4rden i state:t och i andra l\\xE4gen skulle man tolka data som skulle s\\xE4ttas i tv\\xE5 sub-state v\\xE4rden p\\xE5 tv\\xE5 olika s\\xE4tt.\"}),`\n`,(0,n.jsx)(e.p,{children:(0,n.jsx)(e.strong,{children:\"Det \\xE4r i det h\\xE4r l\\xE4get som vi b\\xF6rjade snegla p\\xE5 att anv\\xE4nda useReducer ist\\xE4llet.\"})}),`\n`,(0,n.jsxs)(e.h2,{id:\"fas-3-kasta-ut-usestate-och-v\\xE4lkomna-usereducer\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#fas-3-kasta-ut-usestate-och-v\\xE4lkomna-usereducer\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Fas 3: Kasta ut useState och v\\xE4lkomna useReducer\"]}),`\n`,(0,n.jsx)(e.p,{children:\"Den korta beskrivningen en bit upp i denna text som beskriver de l\\xE4gen som useReducer \\xE4r att rekommendera \\xF6ver useState ang\\xE5ende komplex state-logik och sub-v\\xE4rden \\xE4r v\\xE4ldigt talande f\\xF6r de f\\xF6rdelar vi snabbt s\\xE5g efter att vi hade refaktorerat formul\\xE4rets state till en useReducer ist\\xE4llet.\"}),`\n`,(0,n.jsx)(e.p,{children:\"Att vi b\\xF6rjade snegla mot useReducer b\\xF6rjade v\\xE4l med att vi i princip hade all state-logik p\\xE5 plats och formul\\xE4ret i sin helhet fungerade enligt kravspec, med v\\xE5rat state-objekt.\"}),`\n`,(0,n.jsx)(e.p,{children:\"Men n\\xE4r vi kikade igenom koden k\\xE4ndes det fortfarande som att det var v\\xE4ldigt m\\xE5nga olika callbacks osv d\\xE4r state sattes och vi hade fortfarande kvar alla beroenden mellan sub-v\\xE4rden.\"}),`\n`,(0,n.jsx)(e.p,{children:\"Formul\\xE4r-komponenten var helt enkelt sv\\xE5r att h\\xE4nga med i d\\xE5 det sattes state lite h\\xE4r och d\\xE4r och vi beh\\xF6vde ha stenkoll p\\xE5 i vilka callbacks som validerings-feedback skulle rensas osv.\"}),`\n`,(0,n.jsx)(e.p,{children:\"Formul\\xE4ret i sig beh\\xF6vde \\xE4ven ha koll p\\xE5 att n\\xE4r anv\\xE4ndaren klickar sig bak\\xE5t mellan stegen s\\xE5 ska hela state-objektet rensas om anv\\xE4ndaren klickade sig tillbaka till f\\xF6rsta steget.\"}),`\n`,(0,n.jsxs)(e.h3,{id:\"vad-g\\xF6r-usereducer\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#vad-g\\xF6r-usereducer\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Vad g\\xF6r useReducer?\"]}),`\n`,(0,n.jsxs)(e.p,{children:[\"Vad \\xE4r det d\\xE5 som skiljer useState fr\\xE5n useReducer? useReducer fungerar lite mer som Redux i det s\\xE4tt att useReducer-hooken ger tillbaka \",(0,n.jsx)(e.code,{children:\"state\"}),\" och en \",(0,n.jsx)(e.code,{children:\"dispatch\"}),\" funktion. Via dispatch skickar man olika \\u201Dactions\\u201D med eller utan data f\\xF6r att uppdatera state, via en reducer-funktion:\"]}),`\n`,(0,n.jsx)(e.pre,{className:\"language-js\",children:(0,n.jsx)(e.code,{className:\"language-js code-highlight\",children:(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"const\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"state\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" dispatch\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"useReducer\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"reducer\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" initialState\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]})})}),`\n`,(0,n.jsxs)(e.p,{children:[\"Reducer-funktionen i sin tur tar state:ta nuvarande version och en action som parametrar och vanligtvis (precis som med Redux) s\\xE5 brukar reducern best\\xE5 av en switch/case p\\xE5 \",(0,n.jsx)(e.code,{children:\"action.type\"}),\" d\\xE4r olika action-types uppdaterar state p\\xE5 lite olika s\\xE4tt.\"]}),`\n`,(0,n.jsxs)(e.blockquote,{children:[`\n`,(0,n.jsxs)(e.p,{children:[\"Vill man veta mer om useReducer s\\xE5 \\xE4r den \",(0,n.jsx)(e.a,{href:\"https://reactjs.org/docs/hooks-reference.html\",children:\"officiella dokumentationen\"}),\" en bra startpunkt.\"]}),`\n`]}),`\n`,(0,n.jsxs)(e.p,{children:[\"F\\xF6r den komponent som ska uppdatera state handlar det f\\xF6renklat om att man g\\xE5r fr\\xE5n \",(0,n.jsx)(e.code,{children:\"setState({ ...state, inputOne: value})\"}),\" till \",(0,n.jsx)(e.code,{children:\"dispatch({ type: \\u2019INPUT_ONE\\u2019, value })\"}),\".\"]}),`\n`,(0,n.jsxs)(e.h3,{id:\"vilka-f\\xF6rdelar-s\\xE5g-vi\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#vilka-f\\xF6rdelar-s\\xE5g-vi\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Vilka f\\xF6rdelar s\\xE5g vi?\"]}),`\n`,(0,n.jsx)(e.p,{children:\"Vilka f\\xF6rdelar kunde vi d\\xE5 se n\\xE4r vi refaktorerade fr\\xE5n l\\xF6sningen med useState och v\\xE5rat state-objekt till att anv\\xE4nda useReducer ist\\xE4llet?\"}),`\n`,(0,n.jsxs)(e.p,{children:[\"Den allra st\\xF6rsta f\\xF6rdelen vi s\\xE5g var att formul\\xE4r-komponenten nu bara beh\\xF6vde fokusera p\\xE5 \",(0,n.jsx)(e.strong,{children:\"vad\"}),\" som skulle h\\xE4nda och inte exakt \",(0,n.jsx)(e.strong,{children:\"hur\"}),\" n\\xE5got skulle h\\xE4nda. Om man ska ta exemplet med att l\\xE5ta anv\\xE4ndaren backa i formul\\xE4ret s\\xE5 gick vi fr\\xE5n (ungef\\xE4r):\"]}),`\n`,(0,n.jsx)(e.pre,{className:\"language-js\",children:(0,n.jsxs)(e.code,{className:\"language-js code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line line-number\",line:\"1\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"const\"}),\" \",(0,n.jsx)(e.span,{className:\"token function-variable function\",children:\"onStepChange\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token parameter\",children:\"step\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token arrow operator\",children:\"=\u003e\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line line-number\",line:\"2\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword control-flow\",children:\"if\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"step \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"===\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line line-number\",line:\"3\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token function\",children:\"setState\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"emptyFormData\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line line-number\",line:\"4\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword control-flow\",children:\"return\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line line-number\",line:\"5\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line line-number\",line:\"6\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token function\",children:\"setState\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\" \",(0,n.jsx)(e.span,{className:\"token spread operator\",children:\"...\"}),\"state\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token literal-property property\",children:\"step\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" step \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line line-number\",line:\"7\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]})]})}),`\n`,(0,n.jsx)(e.p,{children:\"Till en l\\xF6sning d\\xE4r formul\\xE4ret inte beh\\xF6vde bry sig om s\\xE5dana detaljer:\"}),`\n`,(0,n.jsx)(e.pre,{className:\"language-js\",children:(0,n.jsxs)(e.code,{className:\"language-js code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line line-number\",line:\"1\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"const\"}),\" \",(0,n.jsx)(e.span,{className:\"token function-variable function\",children:\"onStepChange\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token parameter\",children:\"step\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token arrow operator\",children:\"=\u003e\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line line-number\",line:\"2\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token function\",children:\"dispatch\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\" \",(0,n.jsx)(e.span,{className:\"token literal-property property\",children:\"type\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \\u2019\",(0,n.jsx)(e.span,{className:\"token constant\",children:\"FORM_STEP\"}),\"\\u2019\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token literal-property property\",children:\"step\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" step \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line line-number\",line:\"3\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),`\n`,(0,n.jsx)(e.p,{children:\"V\\xE5r formul\\xE4r-reducer s\\xE5g d\\xE5 till att sj\\xE4lv antingen bara backa ett steg eller rensa hela formul\\xE4ret i sin helhet, d\\xE5 anv\\xE4ndaren backade till f\\xF6rsta steget.\"}),`\n`,(0,n.jsx)(e.p,{children:\"En annan f\\xF6rdel vi s\\xE5g var att formul\\xE4ret inte l\\xE4ngre beh\\xF6vde bry sig om att i vissa l\\xE4gen rensa den validerings-feedback array som fanns i state. S\\xE5dana detaljer var upp till reducern att sk\\xF6ta, beroende p\\xE5 vilken action som formul\\xE4ret dispatchade.\"}),`\n`,(0,n.jsx)(e.p,{children:\"En tredje f\\xF6rdel var att formul\\xE4ret nu inte l\\xE4ngre beh\\xF6vde bry sig alls om eventuella beroenden mellan sub-v\\xE4rden i state:t. Formul\\xE4ret dispatchade bara sina actions med tillh\\xF6rande data och reducern s\\xE5g till att s\\xE4tta eventuella boolean-flaggor osv sj\\xE4lv.\"}),`\n`,(0,n.jsxs)(e.h3,{id:\"mer-boilerplate-kod-men-kontrollerade-state-f\\xF6r\\xE4ndringar\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#mer-boilerplate-kod-men-kontrollerade-state-f\\xF6r\\xE4ndringar\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Mer boilerplate-kod men kontrollerade state-f\\xF6r\\xE4ndringar\"]}),`\n`,(0,n.jsx)(e.p,{children:\"Visserligen innebar useReducern lite mer \\u201Dboilerplate-kod\\u201D, framf\\xF6r allt d\\xE5 vi jobbar med TypeScript och typade upp alla action-typen och payloads som man kunde skicka in i reducern. Men detta innebar ju ocks\\xE5 att vi fick ett tydligare kontrakt mellan formul\\xE4ret och reducern, och hur formul\\xE4ret kunde p\\xE5verka state:t p\\xE5 ett v\\xE4ligt kontrollerat s\\xE4tt.\"}),`\n`,(0,n.jsx)(e.p,{children:\"All boilerplate gjorde det tydligt att vi kunde lyfta ut useReducern till en custom hook. D\\xE5 vi gjorde detta blev dessutom formul\\xE4r-komponenten 100% mer \\xF6versk\\xE5dlig. Nu ansvarade formul\\xE4r-komponenten i princip bara f\\xF6r att h\\xE4mta data fr\\xE5n API:er i vissa funktioner och dispatcha actions, samt dispatcha vissa actions direkt i \\u201DonInputChange-funktioner\\u201D.\"}),`\n`,(0,n.jsxs)(e.p,{children:[\"All faktiskt state-hantering lyftes ut till en separat fil. Beh\\xF6vde vi se hur state:t s\\xE5g ut eller hur det skulle f\\xF6r\\xE4ndras \\xF6ver tid gav reducern oss en tydligare \\xF6verblick, ist\\xE4llet f\\xF6r att beh\\xF6va skrolla runt i formul\\xE4r-komponenten och jaga \",(0,n.jsx)(e.code,{children:\"setState\"}),\" anrop.\"]}),`\n`,(0,n.jsxs)(e.h2,{id:\"summering\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#summering\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Summering\"]}),`\n`,(0,n.jsx)(e.p,{children:\"Phew! D\\xE4r var vi i m\\xE5l!\"}),`\n`,(0,n.jsx)(e.p,{children:\"Vad kan man d\\xE5 dra f\\xF6r summerande slutsatser av det hela? Ska man strunta i useState helt och ist\\xE4llet anv\\xE4nda useReducer? Absolut inte! Hook:en useState \\xE4r v\\xE4ldigt bra om man har ett state som inte \\xE4r speciellt komplext. Att alltid anv\\xE4nda useReducer skulle f\\xF6rmodligen inneb\\xE4ra on\\xF6digt komplex l\\xF6sning f\\xF6r en icke-komplex utmaning.\"}),`\n`,(0,n.jsx)(e.p,{children:\"Men \\xE5 andra sidan tror jag inte man ska vara r\\xE4dd f\\xF6r att byta ut useState mot useReducer i de l\\xE4gen en komponents state v\\xE4xer. Personligen tyckte jag att useReducer s\\xE5g ut som on\\xF6digt avancerat s\\xE4tt att hantera state i funktions-komponenter innan jag testade p\\xE5 den, men s\\xE5g genast f\\xF6rdelar med den n\\xE4r jag v\\xE4l b\\xF6rjade anv\\xE4nda den.\"}),`\n`,(0,n.jsx)(e.p,{children:\"Har man lite mer avancerat state och synkar inte bara input-f\\xE4lt till data eller t\\xE4nder och sl\\xE4cker grejer rent visuellt med boolean-flaggor \\xE4r useReducer ett v\\xE4ldigt bra alternativ f\\xF6r att f\\xE5 b\\xE4ttre kontroll \\xF6ver state och state-f\\xF6r\\xE4ndringar.\"}),`\n`,(0,n.jsxs)(e.blockquote,{children:[`\n`,(0,n.jsxs)(e.p,{children:[\"V\\xE4rt att p\\xE5peka \\xE4r ju att det h\\xE4r \\xE4r tankar och funderingar efter att ha anv\\xE4nt useReducer \",(0,n.jsx)(e.em,{children:\"en\"}),\" g\\xE5ng. Men jag k\\xE4nde \\xE4nd\\xE5 f\\xF6r att f\\xE5 nedskrivet n\\xE5gra reflektioner.\"]}),`\n`]}),`\n`,(0,n.jsx)(e.p,{children:\"N\\xE4sta g\\xE5ng jag st\\xE5r inf\\xF6r lite mer avancerad state kommer jag i alla fall inte tveka att \\xF6verv\\xE4ga useReducer som l\\xF6sning ist\\xE4llet f\\xF6r useState, d\\xE5 man har mycket att vinna p\\xE5 det!\"})]})}function y(a={}){let{wrapper:e}=a.components||{};return e?(0,n.jsx)(e,Object.assign({},a,{children:(0,n.jsx)(d,a)})):d(a)}var j=y;return N(S);})();\n;return Component;"},"_id":"posts/nar-man-formodligen-vill-byta-ut-use-state-mot-use-reducer.mdx","_raw":{"sourceFilePath":"posts/nar-man-formodligen-vill-byta-ut-use-state-mot-use-reducer.mdx","sourceFileName":"nar-man-formodligen-vill-byta-ut-use-state-mot-use-reducer.mdx","sourceFileDir":"posts","contentType":"mdx","flattenedPath":"posts/nar-man-formodligen-vill-byta-ut-use-state-mot-use-reducer"},"type":"Post","url":"/blogg/nar-man-formodligen-vill-byta-ut-use-state-mot-use-reducer","dateFormatted":"2021-02-13"},"prevPost":{"title":"Media Queries √° la styled-components","date":"2020-11-01T00:00:00.000Z","summary":"Tre olika, men ocks√• snarlika, exempel p√• hur man kan jobba med CSS Media Queries i styled-components.","body":{"raw":"\nH√§romdagen experimenterade jag lite med styled-components, som √§r den CSS-in-JS l√∂sning f√∂r styling p√• den h√§r sajten.\n\nJag testade lite olika s√§tt hur man kan hantera media queries p√• ett s√•nt ‚Äùstyled-components-igt‚Äù s√§tt som m√∂jligt. Tillslut landade jag i en l√∂sning som k√§ndes r√§tt schysst.\n\nMed det sagt s√• t√§nkte jag g√• igenom lite olika s√§tt man kan implementera media queries med styled-components p√•.\n\n\u003e Alla exempel p√• media queries kommer utg√• fr√•n en mobile-first approach och anv√§nda **@media (min-width: pixelbredd) {}** som exempel.\n\n## Den allra enklaste l√∂sningen üë∂üèº\n\nL√•t s√§ga att man har en `\u003cParagraph /\u003e` styled-component som ser ut ungef√§r s√• h√§r:\n\n```js:Paragraph.js showLineNumbers\nconst Paragraph = styled.p`\n  color: pink;\n`;\n```\n\nVill man d√• g√∂ra den h√§r komponenten responsiv och exempelvis f√• en annan f√§rg p√• st√∂rre sk√§rmar skulle den kunna se ut s√• h√§r ist√§llet:\n\n```js:Paragraph.js {3-5} showLineNumbers\nconst Paragraph = styled.p`\n  color: pink;\n  @media (min-width: 700px) {\n    color: blue;\n  }\n`;\n```\n\nKomponenten skulle nu allts√• resultera i en rosa paragraf p√• alla sk√§rmstorlekar upp till 700px breda. D√§refter skulle paragrafen vara bl√•. Perfekt.\n\n### Vad kan man d√• s√§ga om den h√§r l√∂sningen?\n\nJo... den √§r v√§ldigt enkel och straight-forward.\n\nNackdelen blir dock att den h√§r komponenten sj√§lv m√•ste h√•lla reda p√• vilken bredd som g√§ller f√∂r att applicera responsiva √§ndringar.\n\nDen h√§r l√∂sningen inneb√§r att varje komponent m√•ste h√•lla reda p√• att det √§r en mobile-first approach som anv√§nds i och med `min-width`.\n\nHar man flera komponenter med likande media queries med just `min-width: 700px` h√•rdkodade i varje komponent m√•ste varje komponent h√•llas i synk om man √§ndrar sin breakpoint-skala. Om man vill √§ndra 700px till 675px exempelvis.\n\nDessutom s√§ger inte 700px _ingenting_ egentligen. Det beskriver inte vad 700px faktiskt _representerar_ - vilket kanske skulle kunna vara ‚ÄùAlla medium-sk√§rmar s√•som tablets och upp√•t‚Äù.\n\n## Den lite mer dynamiska och beskrivande l√∂sningen üßíüèº\n\nHur g√∂r man f√∂reg√•ende l√∂sning lite mer dynamisk p√• s√• s√§tt att varje komponent inte sj√§lva beh√∂ver h√•lla reda p√• de faktiska sk√§rmbredderna? Samtidigt som man f√•r en media query som √§r lite mer beskrivande?\n\nJo man skulle kunna g√∂ra n√•gonting ungef√§r s√• h√§r:\n\n```js:Paragraph.js showLineNumbers\n// L√•tsas att det h√§r breakpoints objektet √§r en annan fil\nexport const breakpoints = {\n  small: '550px',\n  medium: '700px',\n  large: '1024px',\n};\n\n// Importera breakpoints-objektet i Paragraph-komponenten\nimport { breakpoints } from 'somewhere/you/store/breakpoints';\n\nconst Paragraph = styled.p'\n  color: pink;\n  @media (min-width: ${breakpoints.medium}) {\n    color: blue;\n  }\n';\n```\n\n### Vad √§r det som √§r b√§ttre med den h√§r l√∂sningen d√•?\n\nOvanst√•ende exempel inneb√§r att komponenterna inte m√•ste h√•lla reda p√• vad breakpoint-skalan inneh√•ller f√∂r faktiska v√§rden.\n\nBeh√∂ver man justera sin breakpoint-skala beh√∂ver man bara g√∂ra det p√• ett st√§lle - i breakpoints-objektet. Alla ens responsiva komponenter f√•r d√• det nya pixelv√§rdena automatisk.\n\nMen det kanske mest intressant med det h√§r exemplet √§r hur den h√§r l√∂sningen b√§ttre _beskriver_ vad varje breakpoint faktiskt inneb√§r. Detta f√∂r att man har grupperat breakpoint-skalan i ett objekt (eller en array f√∂r den delen) och kan namnge vad man anser att pixelv√§rdena inneb√§r.\n\nI just det h√§r exemplet visade det sig dessutom att 700px ligger i mitten p√• breakpoint-skalan av **small**, **medium** och **large**.\n\n### N√•gra nackdelar?\n\nSj√§lvklart finns det n√•gra nackdelar med den h√§r l√∂sningen.\n\nVarje komponent som ska vara responsiv m√•ste importera breakpoint-skalan som man med f√∂rdel har skapat upp i ett slags theme-objekt.\n\nDessutom m√•ste varje komponent fortfarande h√•lla koll p√• att det √§r `min-width` som g√§ller och inte `max-width` exempelvis.\n\nKomponenterna m√•ste allts√• fortfarande veta vissa implementationsdetaljer kring hur media queries ska anv√§ndas.\n\n## L√∂sningen √° la styled-components üë®üèª‚Äçüéì\n\nHur bygger man d√• egentligen vidare p√• f√∂reg√•ende exempel? Hur f√•r man en media-query-l√∂sning som √§r mer i linje med hur styled-components fungerar?\n\nJo... egentligen skulle man kunna bryta ned det i lite olika steg:\n\n1. **Tema i kontext:** Se till att breakpoints definieras utanf√∂r ens styled-components men blir tillg√§ngliga i komponenterna via Context - ist√§llet f√∂r att komponenterna m√•ste importera skalan hela tiden.\n2. **Media query hj√§lpmedel:** Skapa beskrivande och √•teranv√§ndbara hj√§lpmedel som l√§ser av breakpoints fr√•n Context och spottar ut f√§rdiga media queries. Anv√§nd detta hj√§lpmedel i komponenterna.\n\nEn stor f√∂rdel med styled-components och m√•nga andra CSS-in-JS l√∂sningar f√∂r React √§r att man i sina komponenter kan l√§sa av ett tema fr√•n Context p√• v√§ldigt smidiga s√§tt - som √§r inbyggt i styled-components.\n\n### L√§gg breakpoint i React Context\n\nStyled-components kommer med en f√§rdig l√∂sning f√∂r hur man hanterar temning via Context och tillhandah√•ller √§ven f√§rdiga hooks f√∂r att f√• tag i ThemeContext.\n\n\u003e Vill man l√§sa mer om temning, Context och styled-components s√• g√•r det att g√∂ra [h√§r](https://styled-components.com/docs/advanced#theming).\n\nDet handlar allts√• om att man tar sitt f√§rdiga tema-objekt, som inneh√•ller det breakpoints-objekt med **small**, **medium** och **large** och ser till att det temat tillg√§ngligg√∂rs via en `\u003cThemeProvider\u003e` komponent - h√∂gt upp i ens React-tr√§d av komponenter.\n\nDetta g√∂r d√• allts√• att _alla_ styled-components _automatiskt_ f√•r tillg√•ng till temat.\n\n### Hj√§lpmedel f√∂r tema-medveten media query\n\nVad menar jag d√• egentligen med ett tema-medvetet hj√§lpmedel f√∂r media queries?\n\nDet √§r nog kanske enklast att f√∂rst kika p√• ett kodexempel av det och sen igenom exemplet √∂vergripande:\n\n```js:Media.js showLineNumbers\nconst getBreakpointScaleFromTheme = (breakpoint) =\u003e\n  css(({ theme }) =\u003e theme.breakpoints[breakpoint])\n\nconst breakpointToMediaQuery = (breakpoint) =\u003e (templateStrings) =\u003e css'\n\t@media (min-width: ${getBreakpointScaleFromTheme(breakpoint)} {\n\t  css(templateStrings)\n  }\n'\nexport const media = {\n\tsmall: breakpointToMediaQuery(‚Äôsmall‚Äô),\n\tmedium: breakpointToMediaQuery(‚Äômedium‚Äô),\n\tlarge: breakpointToMediaQuery(‚Äôlarge‚Äô)\n}\n```\n\nOj...Nu vart det kanske lite mycket p√• en g√•ng üßê Let's break it down:\n\n1. Den minsta funktionen `getBreakpointScaleFromTheme` tar som parameter en breakpoint, som i det h√§r fallet √§r **small**, **medium**, eller **large**.\n2. Den funktionen anv√§nder i sina tur `css()`. Vad √§r d√• det f√∂r n√•got? Det √§r en hj√§lpfunktion som exponerar hela ThemeContext, men √§ven eventuella props p√• en styled component.\n3. `getBreakpointScaleFromTheme` ser allts√• till att l√§sa av ThemeContext och h√§mta ut efterfr√•gad breakpoint-v√§rde.\n4. `breakpointToMediaQuery` √§r den funktion som bygger upp sj√§lva media queryn. √Ñven denna funktion tar en breakpoint som parameter.\n   - Den h√§r funktionen returnerar i sin tur _en funktion_ som tar in templateStrings som parameter och skickar den parametern till ett `css(templateStrings)` funktionsanrop - inuti sj√§lva media queryn.\n5. Slutligen s√• exporteras ett objekt som inneh√•ller olika variationer av den templateStrings-funktion som `breakpointToMediaQuery` returnerar.\n\n\u003e Vill man l√§sa mer om temlate strings (eller template literals) s√• har Wes Bos [skrivit](https://wesbos.com/tagged-template-literals) en bra genomg√•ng av hur det hela funkar.\n\nI det h√§r l√§get kan det vara sv√•rt att f√∂rest√§lla sig hur det h√§r media-objektet egentligen ska kunna anv√§ndas i Paragraf-komponenten om man inte √§r speciellt van med styled-components.\n\n### Hur anv√§nder man d√• egentligen det h√§r media-objektet?\n\nVi √•terbes√∂ker Paragraf-komponenten en sista g√•ng och nu kan den ist√§llet se ut s√• h√§r:\n\n```js:Paragraph.js showLineNumbers\nimport { media } from 'where/you/put/media/helper';\n\nconst Paragraph = styled.p'\n\tcolor: pink;\n\t${media.medium'\n\t\tcolor: blue;\n\t'}\n'\n```\n\n**Vad h√§nde egentligen d√§r?**\n\nJo... media √§r som bekant ett objekt med nycklar **small**, **medium** och **large**.\n\nVarje nyckel representerar en funktion som tar en template string som parameter.\n\nI bakgrunden g√∂r funktionerna p√• objektet det som beh√∂vs f√∂r att l√§sa ut breakpoints fr√•n Context och tar hand om implementationsdetaljerna, utan att s√•dant l√§cker ut i komponenterna.\n\n1. **media.small** mappas mot det pixelv√§rde man har specificerat i Context p√• theme.breakpoints.small\n2. **media.medium** mappas mot det pixelv√§rde man har specificerat i Context p√• theme.breakpoints.medium\n3. **media.large** mappas mot det pixelv√§rde man har specificerat i Context p√• theme.breakpoints.large\n\n### Varf√∂r anv√§nda ett s√•nt h√§r tillv√§gag√•ngss√§tt?\n\nK√§nns det spontant som ett komplicerat s√§tt att hantera media queries p√•? Kanske det. _Men..._\n\nTidigare har vi sett exempel p√• media queries i styled-components som √§r helt h√•rdkodade.\n\nVi har ocks√• kikat p√• media queries som l√§ser av en breakpoint-skala fr√•n ett importerat objekt som √§r t√§nkt att representera ett tema.\n\nDet h√§r tredje exemplet m√• vara lite mer komplicerat men kommer, enligt mig, med en rad f√∂rdelar:\n\n- Komponenter beh√∂ver **inte k√§nna till implementationsdetaljer** kring media queries s√•som max-width eller min-width utan komponenter kan fokusera helt p√• _vad_ som ska h√§nda vid en viss breakpoint ist√§llet.\n- Komponenter √§r **inte h√•rt kopplade till den konfiguration** som s√§ger vilka exakta sk√§rmbredder som utg√∂r en viss breakpoint. Den konfigurationen √§r inte intressant f√∂r komponenterna egentligen.\n- Breakpoint-skalan har till **stor del abstraherats bort fr√•n komponenterna** i och med att avl√§sning av Context sker i hj√§lpfunktionerna.\n\nüôãüèº‚Äç‚ôÇÔ∏è Personligen gillar jag det h√§r sista s√§ttet att jobba med media queries. F√∂r denna sajt s√• landade jag i en l√∂sning v√§ldigt lik det tredje exemplet, i alla fall i skrivande stund. Detta f√∂r att jag redan nyttjar ett tema-objekt som l√§ses in i Context och tillg√§ngligg√∂rs i mina styled-components.\n\nN√§r jag d√• skriver mina komponenter beh√∂ver jag inte bry mig om implementationsdetaljer kring hur media queries struktureras i det specifika projektet.\n\nJag importerar bara media-objektet och slipper fokusera p√• _hur_ jag ska skriva mina media queries varje g√•ng en komponent ska ha responsivitet. Ist√§llet fokuserar jag helt p√• _vad_ som ska h√§nda vid varje breakpoint ist√§llet.\n\nGanska smidigt √§nd√•!\n","code":"var Component=(()=\u003e{var m=Object.create;var l=Object.defineProperty;var p=Object.getOwnPropertyDescriptor;var h=Object.getOwnPropertyNames;var k=Object.getPrototypeOf,u=Object.prototype.hasOwnProperty;var g=(a,e)=\u003e()=\u003e(e||a((e={exports:{}}).exports,e),e.exports),N=(a,e)=\u003e{for(var s in e)l(a,s,{get:e[s],enumerable:!0})},i=(a,e,s,r)=\u003e{if(e\u0026\u0026typeof e==\"object\"||typeof e==\"function\")for(let t of h(e))!u.call(a,t)\u0026\u0026t!==s\u0026\u0026l(a,t,{get:()=\u003ee[t],enumerable:!(r=p(e,t))||r.enumerable});return a};var b=(a,e,s)=\u003e(s=a!=null?m(k(a)):{},i(e||!a||!a.__esModule?l(s,\"default\",{value:a,enumerable:!0}):s,a)),v=a=\u003ei(l({},\"__esModule\",{value:!0}),a);var o=g((q,c)=\u003e{c.exports=_jsx_runtime});var x={};N(x,{default:()=\u003ej,frontmatter:()=\u003ef});var n=b(o()),f={title:\"Media Queries \\xE1 la styled-components\",summary:\"Tre olika, men ocks\\xE5 snarlika, exempel p\\xE5 hur man kan jobba med CSS Media Queries i styled-components.\",date:new Date(16041888e5)};function d(a){let e=Object.assign({p:\"p\",blockquote:\"blockquote\",strong:\"strong\",h2:\"h2\",a:\"a\",span:\"span\",code:\"code\",div:\"div\",pre:\"pre\",h3:\"h3\",em:\"em\",ol:\"ol\",li:\"li\",ul:\"ul\"},a.components);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(e.p,{children:\"H\\xE4romdagen experimenterade jag lite med styled-components, som \\xE4r den CSS-in-JS l\\xF6sning f\\xF6r styling p\\xE5 den h\\xE4r sajten.\"}),`\n`,(0,n.jsx)(e.p,{children:\"Jag testade lite olika s\\xE4tt hur man kan hantera media queries p\\xE5 ett s\\xE5nt \\u201Dstyled-components-igt\\u201D s\\xE4tt som m\\xF6jligt. Tillslut landade jag i en l\\xF6sning som k\\xE4ndes r\\xE4tt schysst.\"}),`\n`,(0,n.jsx)(e.p,{children:\"Med det sagt s\\xE5 t\\xE4nkte jag g\\xE5 igenom lite olika s\\xE4tt man kan implementera media queries med styled-components p\\xE5.\"}),`\n`,(0,n.jsxs)(e.blockquote,{children:[`\n`,(0,n.jsxs)(e.p,{children:[\"Alla exempel p\\xE5 media queries kommer utg\\xE5 fr\\xE5n en mobile-first approach och anv\\xE4nda \",(0,n.jsx)(e.strong,{children:\"@media (min-width: pixelbredd) \"}),\" som exempel.\"]}),`\n`]}),`\n`,(0,n.jsxs)(e.h2,{id:\"den-allra-enklaste-l\\xF6sningen-\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#den-allra-enklaste-l\\xF6sningen-\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Den allra enklaste l\\xF6sningen \\u{1F476}\\u{1F3FC}\"]}),`\n`,(0,n.jsxs)(e.p,{children:[\"L\\xE5t s\\xE4ga att man har en \",(0,n.jsx)(e.code,{children:\"\u003cParagraph /\u003e\"}),\" styled-component som ser ut ungef\\xE4r s\\xE5 h\\xE4r:\"]}),`\n`,(0,n.jsx)(e.div,{className:\"rehype-code-title\",children:\"Paragraph.js\"}),(0,n.jsx)(e.pre,{className:\"language-js\",children:(0,n.jsxs)(e.code,{className:\"language-js code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line line-number\",line:\"1\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"const\"}),\" \",(0,n.jsx)(e.span,{className:\"token maybe-class-name\",children:\"Paragraph\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" styled\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token property-access\",children:\"p\"}),(0,n.jsxs)(e.span,{className:\"token template-string\",children:[(0,n.jsx)(e.span,{className:\"token template-punctuation string\",children:\"`\"}),(0,n.jsx)(e.span,{className:\"token css language-css\",children:`\n`})]})]}),(0,n.jsx)(e.span,{className:\"code-line line-number\",line:\"2\",children:(0,n.jsx)(e.span,{className:\"token template-string\",children:(0,n.jsxs)(e.span,{className:\"token css language-css\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token property\",children:\"color\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token color\",children:\"pink\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]})})}),(0,n.jsxs)(e.span,{className:\"code-line line-number\",line:\"3\",children:[(0,n.jsxs)(e.span,{className:\"token template-string\",children:[(0,n.jsx)(e.span,{className:\"token css language-css\"}),(0,n.jsx)(e.span,{className:\"token template-punctuation string\",children:\"`\"})]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]})]})}),`\n`,(0,n.jsx)(e.p,{children:\"Vill man d\\xE5 g\\xF6ra den h\\xE4r komponenten responsiv och exempelvis f\\xE5 en annan f\\xE4rg p\\xE5 st\\xF6rre sk\\xE4rmar skulle den kunna se ut s\\xE5 h\\xE4r ist\\xE4llet:\"}),`\n`,(0,n.jsx)(e.div,{className:\"rehype-code-title\",children:\"Paragraph.js\"}),(0,n.jsx)(e.pre,{className:\"language-js\",children:(0,n.jsxs)(e.code,{className:\"language-js code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line line-number\",line:\"1\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"const\"}),\" \",(0,n.jsx)(e.span,{className:\"token maybe-class-name\",children:\"Paragraph\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" styled\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token property-access\",children:\"p\"}),(0,n.jsxs)(e.span,{className:\"token template-string\",children:[(0,n.jsx)(e.span,{className:\"token template-punctuation string\",children:\"`\"}),(0,n.jsx)(e.span,{className:\"token css language-css\",children:`\n`})]})]}),(0,n.jsx)(e.span,{className:\"code-line line-number\",line:\"2\",children:(0,n.jsx)(e.span,{className:\"token template-string\",children:(0,n.jsxs)(e.span,{className:\"token css language-css\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token property\",children:\"color\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token color\",children:\"pink\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]})})}),(0,n.jsx)(e.span,{className:\"code-line line-number highlight-line\",line:\"3\",children:(0,n.jsx)(e.span,{className:\"token template-string\",children:(0,n.jsxs)(e.span,{className:\"token css language-css\",children:[\"  \",(0,n.jsxs)(e.span,{className:\"token atrule\",children:[(0,n.jsx)(e.span,{className:\"token rule\",children:\"@media\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token property\",children:\"min-width\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"700\"}),(0,n.jsx)(e.span,{className:\"token unit\",children:\"px\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"})]}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]})})}),(0,n.jsx)(e.span,{className:\"code-line line-number highlight-line\",line:\"4\",children:(0,n.jsx)(e.span,{className:\"token template-string\",children:(0,n.jsxs)(e.span,{className:\"token css language-css\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token property\",children:\"color\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token color\",children:\"blue\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]})})}),(0,n.jsx)(e.span,{className:\"code-line line-number highlight-line\",line:\"5\",children:(0,n.jsx)(e.span,{className:\"token template-string\",children:(0,n.jsxs)(e.span,{className:\"token css language-css\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})})}),(0,n.jsxs)(e.span,{className:\"code-line line-number\",line:\"6\",children:[(0,n.jsxs)(e.span,{className:\"token template-string\",children:[(0,n.jsx)(e.span,{className:\"token css language-css\"}),(0,n.jsx)(e.span,{className:\"token template-punctuation string\",children:\"`\"})]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]})]})}),`\n`,(0,n.jsx)(e.p,{children:\"Komponenten skulle nu allts\\xE5 resultera i en rosa paragraf p\\xE5 alla sk\\xE4rmstorlekar upp till 700px breda. D\\xE4refter skulle paragrafen vara bl\\xE5. Perfekt.\"}),`\n`,(0,n.jsxs)(e.h3,{id:\"vad-kan-man-d\\xE5-s\\xE4ga-om-den-h\\xE4r-l\\xF6sningen\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#vad-kan-man-d\\xE5-s\\xE4ga-om-den-h\\xE4r-l\\xF6sningen\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Vad kan man d\\xE5 s\\xE4ga om den h\\xE4r l\\xF6sningen?\"]}),`\n`,(0,n.jsx)(e.p,{children:\"Jo... den \\xE4r v\\xE4ldigt enkel och straight-forward.\"}),`\n`,(0,n.jsx)(e.p,{children:\"Nackdelen blir dock att den h\\xE4r komponenten sj\\xE4lv m\\xE5ste h\\xE5lla reda p\\xE5 vilken bredd som g\\xE4ller f\\xF6r att applicera responsiva \\xE4ndringar.\"}),`\n`,(0,n.jsxs)(e.p,{children:[\"Den h\\xE4r l\\xF6sningen inneb\\xE4r att varje komponent m\\xE5ste h\\xE5lla reda p\\xE5 att det \\xE4r en mobile-first approach som anv\\xE4nds i och med \",(0,n.jsx)(e.code,{children:\"min-width\"}),\".\"]}),`\n`,(0,n.jsxs)(e.p,{children:[\"Har man flera komponenter med likande media queries med just \",(0,n.jsx)(e.code,{children:\"min-width: 700px\"}),\" h\\xE5rdkodade i varje komponent m\\xE5ste varje komponent h\\xE5llas i synk om man \\xE4ndrar sin breakpoint-skala. Om man vill \\xE4ndra 700px till 675px exempelvis.\"]}),`\n`,(0,n.jsxs)(e.p,{children:[\"Dessutom s\\xE4ger inte 700px \",(0,n.jsx)(e.em,{children:\"ingenting\"}),\" egentligen. Det beskriver inte vad 700px faktiskt \",(0,n.jsx)(e.em,{children:\"representerar\"}),\" - vilket kanske skulle kunna vara \\u201DAlla medium-sk\\xE4rmar s\\xE5som tablets och upp\\xE5t\\u201D.\"]}),`\n`,(0,n.jsxs)(e.h2,{id:\"den-lite-mer-dynamiska-och-beskrivande-l\\xF6sningen-\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#den-lite-mer-dynamiska-och-beskrivande-l\\xF6sningen-\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Den lite mer dynamiska och beskrivande l\\xF6sningen \\u{1F9D2}\\u{1F3FC}\"]}),`\n`,(0,n.jsx)(e.p,{children:\"Hur g\\xF6r man f\\xF6reg\\xE5ende l\\xF6sning lite mer dynamisk p\\xE5 s\\xE5 s\\xE4tt att varje komponent inte sj\\xE4lva beh\\xF6ver h\\xE5lla reda p\\xE5 de faktiska sk\\xE4rmbredderna? Samtidigt som man f\\xE5r en media query som \\xE4r lite mer beskrivande?\"}),`\n`,(0,n.jsx)(e.p,{children:\"Jo man skulle kunna g\\xF6ra n\\xE5gonting ungef\\xE4r s\\xE5 h\\xE4r:\"}),`\n`,(0,n.jsx)(e.div,{className:\"rehype-code-title\",children:\"Paragraph.js\"}),(0,n.jsx)(e.pre,{className:\"language-js\",children:(0,n.jsxs)(e.code,{className:\"language-js code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line line-number\",line:\"1\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"// L\\xE5tsas att det h\\xE4r breakpoints objektet \\xE4r en annan fil\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line line-number\",line:\"2\",children:[(0,n.jsx)(e.span,{className:\"token keyword module\",children:\"export\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"const\"}),\" breakpoints \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line line-number\",line:\"3\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token literal-property property\",children:\"small\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'550px'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line line-number\",line:\"4\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token literal-property property\",children:\"medium\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'700px'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line line-number\",line:\"5\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token literal-property property\",children:\"large\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'1024px'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line line-number\",line:\"6\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line line-number\",line:\"7\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line line-number\",line:\"8\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"// Importera breakpoints-objektet i Paragraph-komponenten\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line line-number\",line:\"9\",children:[(0,n.jsx)(e.span,{className:\"token keyword module\",children:\"import\"}),\" \",(0,n.jsxs)(e.span,{className:\"token imports\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\" breakpoints \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"})]}),\" \",(0,n.jsx)(e.span,{className:\"token keyword module\",children:\"from\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'somewhere/you/store/breakpoints'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line line-number\",line:\"10\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line line-number\",line:\"11\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"const\"}),\" \",(0,n.jsx)(e.span,{className:\"token maybe-class-name\",children:\"Paragraph\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" styled\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token property-access\",children:\"p\"}),`'\n`]}),(0,n.jsxs)(e.span,{className:\"code-line line-number\",line:\"12\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token literal-property property\",children:\"color\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" pink\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line line-number\",line:\"13\",children:[\"  @\",(0,n.jsx)(e.span,{className:\"token function\",children:\"media\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsxs)(e.span,{className:\"token parameter\",children:[\"min\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"-\"}),\"width\",(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" $\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"breakpoints\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token property-access\",children:\"medium\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"})]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line line-number\",line:\"14\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token literal-property property\",children:\"color\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" blue\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line line-number\",line:\"15\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line line-number\",line:\"16\",children:[\"'\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]})]})}),`\n`,(0,n.jsxs)(e.h3,{id:\"vad-\\xE4r-det-som-\\xE4r-b\\xE4ttre-med-den-h\\xE4r-l\\xF6sningen-d\\xE5\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#vad-\\xE4r-det-som-\\xE4r-b\\xE4ttre-med-den-h\\xE4r-l\\xF6sningen-d\\xE5\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Vad \\xE4r det som \\xE4r b\\xE4ttre med den h\\xE4r l\\xF6sningen d\\xE5?\"]}),`\n`,(0,n.jsx)(e.p,{children:\"Ovanst\\xE5ende exempel inneb\\xE4r att komponenterna inte m\\xE5ste h\\xE5lla reda p\\xE5 vad breakpoint-skalan inneh\\xE5ller f\\xF6r faktiska v\\xE4rden.\"}),`\n`,(0,n.jsx)(e.p,{children:\"Beh\\xF6ver man justera sin breakpoint-skala beh\\xF6ver man bara g\\xF6ra det p\\xE5 ett st\\xE4lle - i breakpoints-objektet. Alla ens responsiva komponenter f\\xE5r d\\xE5 det nya pixelv\\xE4rdena automatisk.\"}),`\n`,(0,n.jsxs)(e.p,{children:[\"Men det kanske mest intressant med det h\\xE4r exemplet \\xE4r hur den h\\xE4r l\\xF6sningen b\\xE4ttre \",(0,n.jsx)(e.em,{children:\"beskriver\"}),\" vad varje breakpoint faktiskt inneb\\xE4r. Detta f\\xF6r att man har grupperat breakpoint-skalan i ett objekt (eller en array f\\xF6r den delen) och kan namnge vad man anser att pixelv\\xE4rdena inneb\\xE4r.\"]}),`\n`,(0,n.jsxs)(e.p,{children:[\"I just det h\\xE4r exemplet visade det sig dessutom att 700px ligger i mitten p\\xE5 breakpoint-skalan av \",(0,n.jsx)(e.strong,{children:\"small\"}),\", \",(0,n.jsx)(e.strong,{children:\"medium\"}),\" och \",(0,n.jsx)(e.strong,{children:\"large\"}),\".\"]}),`\n`,(0,n.jsxs)(e.h3,{id:\"n\\xE5gra-nackdelar\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#n\\xE5gra-nackdelar\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"N\\xE5gra nackdelar?\"]}),`\n`,(0,n.jsx)(e.p,{children:\"Sj\\xE4lvklart finns det n\\xE5gra nackdelar med den h\\xE4r l\\xF6sningen.\"}),`\n`,(0,n.jsx)(e.p,{children:\"Varje komponent som ska vara responsiv m\\xE5ste importera breakpoint-skalan som man med f\\xF6rdel har skapat upp i ett slags theme-objekt.\"}),`\n`,(0,n.jsxs)(e.p,{children:[\"Dessutom m\\xE5ste varje komponent fortfarande h\\xE5lla koll p\\xE5 att det \\xE4r \",(0,n.jsx)(e.code,{children:\"min-width\"}),\" som g\\xE4ller och inte \",(0,n.jsx)(e.code,{children:\"max-width\"}),\" exempelvis.\"]}),`\n`,(0,n.jsx)(e.p,{children:\"Komponenterna m\\xE5ste allts\\xE5 fortfarande veta vissa implementationsdetaljer kring hur media queries ska anv\\xE4ndas.\"}),`\n`,(0,n.jsxs)(e.h2,{id:\"l\\xF6sningen-\\xE1-la-styled-components-\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#l\\xF6sningen-\\xE1-la-styled-components-\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"L\\xF6sningen \\xE1 la styled-components \\u{1F468}\\u{1F3FB}\\u200D\\u{1F393}\"]}),`\n`,(0,n.jsx)(e.p,{children:\"Hur bygger man d\\xE5 egentligen vidare p\\xE5 f\\xF6reg\\xE5ende exempel? Hur f\\xE5r man en media-query-l\\xF6sning som \\xE4r mer i linje med hur styled-components fungerar?\"}),`\n`,(0,n.jsx)(e.p,{children:\"Jo... egentligen skulle man kunna bryta ned det i lite olika steg:\"}),`\n`,(0,n.jsxs)(e.ol,{children:[`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Tema i kontext:\"}),\" Se till att breakpoints definieras utanf\\xF6r ens styled-components men blir tillg\\xE4ngliga i komponenterna via Context - ist\\xE4llet f\\xF6r att komponenterna m\\xE5ste importera skalan hela tiden.\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"Media query hj\\xE4lpmedel:\"}),\" Skapa beskrivande och \\xE5teranv\\xE4ndbara hj\\xE4lpmedel som l\\xE4ser av breakpoints fr\\xE5n Context och spottar ut f\\xE4rdiga media queries. Anv\\xE4nd detta hj\\xE4lpmedel i komponenterna.\"]}),`\n`]}),`\n`,(0,n.jsx)(e.p,{children:\"En stor f\\xF6rdel med styled-components och m\\xE5nga andra CSS-in-JS l\\xF6sningar f\\xF6r React \\xE4r att man i sina komponenter kan l\\xE4sa av ett tema fr\\xE5n Context p\\xE5 v\\xE4ldigt smidiga s\\xE4tt - som \\xE4r inbyggt i styled-components.\"}),`\n`,(0,n.jsxs)(e.h3,{id:\"l\\xE4gg-breakpoint-i-react-context\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#l\\xE4gg-breakpoint-i-react-context\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"L\\xE4gg breakpoint i React Context\"]}),`\n`,(0,n.jsx)(e.p,{children:\"Styled-components kommer med en f\\xE4rdig l\\xF6sning f\\xF6r hur man hanterar temning via Context och tillhandah\\xE5ller \\xE4ven f\\xE4rdiga hooks f\\xF6r att f\\xE5 tag i ThemeContext.\"}),`\n`,(0,n.jsxs)(e.blockquote,{children:[`\n`,(0,n.jsxs)(e.p,{children:[\"Vill man l\\xE4sa mer om temning, Context och styled-components s\\xE5 g\\xE5r det att g\\xF6ra \",(0,n.jsx)(e.a,{href:\"https://styled-components.com/docs/advanced#theming\",children:\"h\\xE4r\"}),\".\"]}),`\n`]}),`\n`,(0,n.jsxs)(e.p,{children:[\"Det handlar allts\\xE5 om att man tar sitt f\\xE4rdiga tema-objekt, som inneh\\xE5ller det breakpoints-objekt med \",(0,n.jsx)(e.strong,{children:\"small\"}),\", \",(0,n.jsx)(e.strong,{children:\"medium\"}),\" och \",(0,n.jsx)(e.strong,{children:\"large\"}),\" och ser till att det temat tillg\\xE4ngligg\\xF6rs via en \",(0,n.jsx)(e.code,{children:\"\u003cThemeProvider\u003e\"}),\" komponent - h\\xF6gt upp i ens React-tr\\xE4d av komponenter.\"]}),`\n`,(0,n.jsxs)(e.p,{children:[\"Detta g\\xF6r d\\xE5 allts\\xE5 att \",(0,n.jsx)(e.em,{children:\"alla\"}),\" styled-components \",(0,n.jsx)(e.em,{children:\"automatiskt\"}),\" f\\xE5r tillg\\xE5ng till temat.\"]}),`\n`,(0,n.jsxs)(e.h3,{id:\"hj\\xE4lpmedel-f\\xF6r-tema-medveten-media-query\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#hj\\xE4lpmedel-f\\xF6r-tema-medveten-media-query\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Hj\\xE4lpmedel f\\xF6r tema-medveten media query\"]}),`\n`,(0,n.jsx)(e.p,{children:\"Vad menar jag d\\xE5 egentligen med ett tema-medvetet hj\\xE4lpmedel f\\xF6r media queries?\"}),`\n`,(0,n.jsx)(e.p,{children:\"Det \\xE4r nog kanske enklast att f\\xF6rst kika p\\xE5 ett kodexempel av det och sen igenom exemplet \\xF6vergripande:\"}),`\n`,(0,n.jsx)(e.div,{className:\"rehype-code-title\",children:\"Media.js\"}),(0,n.jsx)(e.pre,{className:\"language-js\",children:(0,n.jsxs)(e.code,{className:\"language-js code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line line-number\",line:\"1\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"const\"}),\" \",(0,n.jsx)(e.span,{className:\"token function-variable function\",children:\"getBreakpointScaleFromTheme\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token parameter\",children:\"breakpoint\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token arrow operator\",children:\"=\u003e\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line line-number\",line:\"2\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token function\",children:\"css\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsxs)(e.span,{className:\"token parameter\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\" theme \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"})]}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token arrow operator\",children:\"=\u003e\"}),\" theme\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token property-access\",children:\"breakpoints\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"breakpoint\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line line-number\",line:\"3\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line line-number\",line:\"4\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"const\"}),\" \",(0,n.jsx)(e.span,{className:\"token function-variable function\",children:\"breakpointToMediaQuery\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token parameter\",children:\"breakpoint\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token arrow operator\",children:\"=\u003e\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token parameter\",children:\"templateStrings\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token arrow operator\",children:\"=\u003e\"}),` css'\n`]}),(0,n.jsxs)(e.span,{className:\"code-line line-number\",line:\"5\",children:[\"\t@\",(0,n.jsx)(e.span,{className:\"token function\",children:\"media\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"min\",(0,n.jsx)(e.span,{className:\"token operator\",children:\"-\"}),\"width\",(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" $\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"getBreakpointScaleFromTheme\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"breakpoint\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line line-number\",line:\"6\",children:[\"\t  \",(0,n.jsx)(e.span,{className:\"token function\",children:\"css\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"templateStrings\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line line-number\",line:\"7\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line line-number\",line:\"8\",children:`'\n`}),(0,n.jsxs)(e.span,{className:\"code-line line-number\",line:\"9\",children:[(0,n.jsx)(e.span,{className:\"token keyword module\",children:\"export\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"const\"}),\" media \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line line-number\",line:\"10\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token literal-property property\",children:\"small\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"breakpointToMediaQuery\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"\\u2019small\\u2019\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line line-number\",line:\"11\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token literal-property property\",children:\"medium\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"breakpointToMediaQuery\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"\\u2019medium\\u2019\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line line-number\",line:\"12\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token literal-property property\",children:\"large\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"breakpointToMediaQuery\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"\\u2019large\\u2019\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line line-number\",line:\"13\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),`\n`,(0,n.jsx)(e.p,{children:\"Oj...Nu vart det kanske lite mycket p\\xE5 en g\\xE5ng \\u{1F9D0} Let's break it down:\"}),`\n`,(0,n.jsxs)(e.ol,{children:[`\n`,(0,n.jsxs)(e.li,{children:[\"Den minsta funktionen \",(0,n.jsx)(e.code,{children:\"getBreakpointScaleFromTheme\"}),\" tar som parameter en breakpoint, som i det h\\xE4r fallet \\xE4r \",(0,n.jsx)(e.strong,{children:\"small\"}),\", \",(0,n.jsx)(e.strong,{children:\"medium\"}),\", eller \",(0,n.jsx)(e.strong,{children:\"large\"}),\".\"]}),`\n`,(0,n.jsxs)(e.li,{children:[\"Den funktionen anv\\xE4nder i sina tur \",(0,n.jsx)(e.code,{children:\"css()\"}),\". Vad \\xE4r d\\xE5 det f\\xF6r n\\xE5got? Det \\xE4r en hj\\xE4lpfunktion som exponerar hela ThemeContext, men \\xE4ven eventuella props p\\xE5 en styled component.\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.code,{children:\"getBreakpointScaleFromTheme\"}),\" ser allts\\xE5 till att l\\xE4sa av ThemeContext och h\\xE4mta ut efterfr\\xE5gad breakpoint-v\\xE4rde.\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.code,{children:\"breakpointToMediaQuery\"}),\" \\xE4r den funktion som bygger upp sj\\xE4lva media queryn. \\xC4ven denna funktion tar en breakpoint som parameter.\",`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsxs)(e.li,{children:[\"Den h\\xE4r funktionen returnerar i sin tur \",(0,n.jsx)(e.em,{children:\"en funktion\"}),\" som tar in templateStrings som parameter och skickar den parametern till ett \",(0,n.jsx)(e.code,{children:\"css(templateStrings)\"}),\" funktionsanrop - inuti sj\\xE4lva media queryn.\"]}),`\n`]}),`\n`]}),`\n`,(0,n.jsxs)(e.li,{children:[\"Slutligen s\\xE5 exporteras ett objekt som inneh\\xE5ller olika variationer av den templateStrings-funktion som \",(0,n.jsx)(e.code,{children:\"breakpointToMediaQuery\"}),\" returnerar.\"]}),`\n`]}),`\n`,(0,n.jsxs)(e.blockquote,{children:[`\n`,(0,n.jsxs)(e.p,{children:[\"Vill man l\\xE4sa mer om temlate strings (eller template literals) s\\xE5 har Wes Bos \",(0,n.jsx)(e.a,{href:\"https://wesbos.com/tagged-template-literals\",children:\"skrivit\"}),\" en bra genomg\\xE5ng av hur det hela funkar.\"]}),`\n`]}),`\n`,(0,n.jsx)(e.p,{children:\"I det h\\xE4r l\\xE4get kan det vara sv\\xE5rt att f\\xF6rest\\xE4lla sig hur det h\\xE4r media-objektet egentligen ska kunna anv\\xE4ndas i Paragraf-komponenten om man inte \\xE4r speciellt van med styled-components.\"}),`\n`,(0,n.jsxs)(e.h3,{id:\"hur-anv\\xE4nder-man-d\\xE5-egentligen-det-h\\xE4r-media-objektet\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#hur-anv\\xE4nder-man-d\\xE5-egentligen-det-h\\xE4r-media-objektet\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Hur anv\\xE4nder man d\\xE5 egentligen det h\\xE4r media-objektet?\"]}),`\n`,(0,n.jsx)(e.p,{children:\"Vi \\xE5terbes\\xF6ker Paragraf-komponenten en sista g\\xE5ng och nu kan den ist\\xE4llet se ut s\\xE5 h\\xE4r:\"}),`\n`,(0,n.jsx)(e.div,{className:\"rehype-code-title\",children:\"Paragraph.js\"}),(0,n.jsx)(e.pre,{className:\"language-js\",children:(0,n.jsxs)(e.code,{className:\"language-js code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line line-number\",line:\"1\",children:[(0,n.jsx)(e.span,{className:\"token keyword module\",children:\"import\"}),\" \",(0,n.jsxs)(e.span,{className:\"token imports\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\" media \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"})]}),\" \",(0,n.jsx)(e.span,{className:\"token keyword module\",children:\"from\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'where/you/put/media/helper'\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line line-number\",line:\"2\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line line-number\",line:\"3\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"const\"}),\" \",(0,n.jsx)(e.span,{className:\"token maybe-class-name\",children:\"Paragraph\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" styled\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token property-access\",children:\"p\"}),`'\n`]}),(0,n.jsxs)(e.span,{className:\"code-line line-number\",line:\"4\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token literal-property property\",children:\"color\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" pink\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line line-number\",line:\"5\",children:[\"\t$\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"media\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token property-access\",children:\"medium\"}),`'\n`]}),(0,n.jsxs)(e.span,{className:\"code-line line-number\",line:\"6\",children:[\"\t\t\",(0,n.jsx)(e.span,{className:\"token literal-property property\",children:\"color\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\":\"}),\" blue\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line line-number\",line:\"7\",children:[\"\t'\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line line-number\",line:\"8\",children:`'\n`})]})}),`\n`,(0,n.jsx)(e.p,{children:(0,n.jsx)(e.strong,{children:\"Vad h\\xE4nde egentligen d\\xE4r?\"})}),`\n`,(0,n.jsxs)(e.p,{children:[\"Jo... media \\xE4r som bekant ett objekt med nycklar \",(0,n.jsx)(e.strong,{children:\"small\"}),\", \",(0,n.jsx)(e.strong,{children:\"medium\"}),\" och \",(0,n.jsx)(e.strong,{children:\"large\"}),\".\"]}),`\n`,(0,n.jsx)(e.p,{children:\"Varje nyckel representerar en funktion som tar en template string som parameter.\"}),`\n`,(0,n.jsx)(e.p,{children:\"I bakgrunden g\\xF6r funktionerna p\\xE5 objektet det som beh\\xF6vs f\\xF6r att l\\xE4sa ut breakpoints fr\\xE5n Context och tar hand om implementationsdetaljerna, utan att s\\xE5dant l\\xE4cker ut i komponenterna.\"}),`\n`,(0,n.jsxs)(e.ol,{children:[`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"media.small\"}),\" mappas mot det pixelv\\xE4rde man har specificerat i Context p\\xE5 theme.breakpoints.small\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"media.medium\"}),\" mappas mot det pixelv\\xE4rde man har specificerat i Context p\\xE5 theme.breakpoints.medium\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\"media.large\"}),\" mappas mot det pixelv\\xE4rde man har specificerat i Context p\\xE5 theme.breakpoints.large\"]}),`\n`]}),`\n`,(0,n.jsxs)(e.h3,{id:\"varf\\xF6r-anv\\xE4nda-ett-s\\xE5nt-h\\xE4r-tillv\\xE4gag\\xE5ngss\\xE4tt\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#varf\\xF6r-anv\\xE4nda-ett-s\\xE5nt-h\\xE4r-tillv\\xE4gag\\xE5ngss\\xE4tt\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Varf\\xF6r anv\\xE4nda ett s\\xE5nt h\\xE4r tillv\\xE4gag\\xE5ngss\\xE4tt?\"]}),`\n`,(0,n.jsxs)(e.p,{children:[\"K\\xE4nns det spontant som ett komplicerat s\\xE4tt att hantera media queries p\\xE5? Kanske det. \",(0,n.jsx)(e.em,{children:\"Men...\"})]}),`\n`,(0,n.jsx)(e.p,{children:\"Tidigare har vi sett exempel p\\xE5 media queries i styled-components som \\xE4r helt h\\xE5rdkodade.\"}),`\n`,(0,n.jsx)(e.p,{children:\"Vi har ocks\\xE5 kikat p\\xE5 media queries som l\\xE4ser av en breakpoint-skala fr\\xE5n ett importerat objekt som \\xE4r t\\xE4nkt att representera ett tema.\"}),`\n`,(0,n.jsx)(e.p,{children:\"Det h\\xE4r tredje exemplet m\\xE5 vara lite mer komplicerat men kommer, enligt mig, med en rad f\\xF6rdelar:\"}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsxs)(e.li,{children:[\"Komponenter beh\\xF6ver \",(0,n.jsx)(e.strong,{children:\"inte k\\xE4nna till implementationsdetaljer\"}),\" kring media queries s\\xE5som max-width eller min-width utan komponenter kan fokusera helt p\\xE5 \",(0,n.jsx)(e.em,{children:\"vad\"}),\" som ska h\\xE4nda vid en viss breakpoint ist\\xE4llet.\"]}),`\n`,(0,n.jsxs)(e.li,{children:[\"Komponenter \\xE4r \",(0,n.jsx)(e.strong,{children:\"inte h\\xE5rt kopplade till den konfiguration\"}),\" som s\\xE4ger vilka exakta sk\\xE4rmbredder som utg\\xF6r en viss breakpoint. Den konfigurationen \\xE4r inte intressant f\\xF6r komponenterna egentligen.\"]}),`\n`,(0,n.jsxs)(e.li,{children:[\"Breakpoint-skalan har till \",(0,n.jsx)(e.strong,{children:\"stor del abstraherats bort fr\\xE5n komponenterna\"}),\" i och med att avl\\xE4sning av Context sker i hj\\xE4lpfunktionerna.\"]}),`\n`]}),`\n`,(0,n.jsx)(e.p,{children:\"\\u{1F64B}\\u{1F3FC}\\u200D\\u2642\\uFE0F Personligen gillar jag det h\\xE4r sista s\\xE4ttet att jobba med media queries. F\\xF6r denna sajt s\\xE5 landade jag i en l\\xF6sning v\\xE4ldigt lik det tredje exemplet, i alla fall i skrivande stund. Detta f\\xF6r att jag redan nyttjar ett tema-objekt som l\\xE4ses in i Context och tillg\\xE4ngligg\\xF6rs i mina styled-components.\"}),`\n`,(0,n.jsx)(e.p,{children:\"N\\xE4r jag d\\xE5 skriver mina komponenter beh\\xF6ver jag inte bry mig om implementationsdetaljer kring hur media queries struktureras i det specifika projektet.\"}),`\n`,(0,n.jsxs)(e.p,{children:[\"Jag importerar bara media-objektet och slipper fokusera p\\xE5 \",(0,n.jsx)(e.em,{children:\"hur\"}),\" jag ska skriva mina media queries varje g\\xE5ng en komponent ska ha responsivitet. Ist\\xE4llet fokuserar jag helt p\\xE5 \",(0,n.jsx)(e.em,{children:\"vad\"}),\" som ska h\\xE4nda vid varje breakpoint ist\\xE4llet.\"]}),`\n`,(0,n.jsx)(e.p,{children:\"Ganska smidigt \\xE4nd\\xE5!\"})]})}function y(a={}){let{wrapper:e}=a.components||{};return e?(0,n.jsx)(e,Object.assign({},a,{children:(0,n.jsx)(d,a)})):d(a)}var j=y;return v(x);})();\n;return Component;"},"_id":"posts/media-queries-a-la-styled-components.mdx","_raw":{"sourceFilePath":"posts/media-queries-a-la-styled-components.mdx","sourceFileName":"media-queries-a-la-styled-components.mdx","sourceFileDir":"posts","contentType":"mdx","flattenedPath":"posts/media-queries-a-la-styled-components"},"type":"Post","url":"/blogg/media-queries-a-la-styled-components","dateFormatted":"2020-11-01"},"nextPost":{"title":"Hur Aftonbladet pajade min sajt och varf√∂r det √§r okej att l√•ta det ligga i backloggen tillsvidare","date":"2021-07-09T00:00:00.000Z","summary":"F√∂r ett tag sedan gjorde Aftonbladet ganska stora √§ndringar p√• sin startsida som resulterade till att en av mina sajter i princip vart v√§rdel√∂s. Men det √§r helt okej!","description":"Aftonbladet har b√∂rjat med lazy loading p√• sin startsida. Det h√§r h√§nde d√• med min sajt/scraper.","body":{"raw":"\n## Sajten\n\nJag har tidigare [skrivit lite](/blogg/att-vacka-liv-i-ett-3-ar-gammalt-projekt) om en sajt/scraper jag byggt - som via en api-endpoint parsa startsidan p√• Aftonbladet och sparar ned viss data om Aftonbladets startsida i Google Firebase.\n\nEndpointen anropas dagligen klockan 12 och har nu fungerat felfritt i ett antal √•r, fram till i √•r.\n\n## Aftonbladet f√∂rst√∂r f√∂r scrapern\n\n![Data insamlat fr√•n start](/img/posts/scraper-1.jpg)\n\nBilden ovan illustrerar data f√∂r varje dag som scrapern har skannat av Aftonbladets startsida fr√•n f√∂rsta dagen till skrivande stund (juli 2021).\n\n\u003e N√•got som √§r helt orelaterat men √§nd√• intressant √§r om man tittar fr√•n 2017-2019. Aftonbladet drog ned anv√§ndandet av ‚úî i sina artikelpuffar r√§tt s√• mycket under den h√§r perioden. Sedan pandemin drog ig√•ng 2020 s√• gick anv√§ndandet upp igen d√§remot. Men nu var det inte det vi skulle fokusera p√•.\n\nI b√∂rjan p√• 2021 s√• ser man n√•got avvikande. Helt pl√∂tsligt f√•ngar scrapern inte alls lika mycket data. Beror det p√• att anv√§ndandet av ‚úî har minskat?\n\nN√§r jag uppt√§ckte det h√§r (lite i efterhand) s√• bes√∂kte jag Aftonbladet f√∂r att se vad som kan ha h√§nt. Har dom √§ndrat HTML-strukturen f√∂r att f√•nga alla ‚úî?\n\nJag skrollade runt p√• sajten och uppt√§ckte att Aftonbladet laddar inte in hela startsidan p√• en g√•ng l√§ngre utan dom har implementerat **Infinite scroll** - inneh√•ll laddar allt eftersom man skrollar.\n\nInte s√• konstigt att min scraper misslyckas med att samla in alla data korrekt allts√•.\n\nKikar man p√• den h√§r bilden s√• verkar det dessutom som att Aftonbladet lanserade denna feature 20/01/2021:\n![N√§rbild p√• data](/img/posts/scraper-2.jpg)\n\nDen dagen f√•ngades bara 12 stycken checkar och sedan dess har mycket f√∂rre checkar sparats ned i Google Firebase.\n\n## √Ñnnu f√§rre datapunkter efter ett tag\n\nJaha. Min scraper f√•ngar inte l√§ngre alla checkar som anv√§nds p√• startsidan. N√§r jag uppt√§ckte det h√§r problemet gjorde jag dock inget √•t det p√• en g√•ng.\n\nJag h√∂ll d√§remot lite koll under 2021 och kunde efter ett tag se det h√§r fenomenet:\n![N√§rbild p√• data](/img/posts/scraper-3.jpg)\n\nHelt pl√∂tsligt f√•ngades **ingen data** alls. Vad har Aftonbladet nu hittat p√•? N√§r jag uppt√§ckte detta gick jag till deras startsida och kunde se att checkar ritades ju faktiskt ut.\n\nJag inspekterade HTML-koden och kunde se att checkarna d√§remot ritades ut p√• ett nytt s√§tt. Min scraper kunde inte urskilja dem d√• scrapern letade efter en css-klass som inte l√§ngre anv√§ndes f√∂r att rita ut checkarna.\n\n## Att fixa eller inte fixa\n\nNu var allts√• min scraper helt trasig egentligen och skulle beh√∂va uppdateras:\n\n- Se till att hela startsidan l√§ses in i scrapern f√∂r att f√•nga alla checkar.\n- Uppdatera scrapern f√∂r att identifiera checkarna p√• nytt.\n- _(Nice to have) n√•gon slags monitorering f√∂r att snabbare f√•nga om scrapern f√•ngar ett avvikande antal datapunkter._\n\n√Ñr det h√§r n√•got jag har fixat? Nope‚Ä¶ Det h√§r √§r ju bara ett litet sidoprojekt, som dessutom inte kostar mig n√•got i drift eller s√•. Det k√§nns inte heller v√§rt att sl√§cka ned sajten d√• den √§nd√• har historisk data fr√•n 2017 som √§nd√• √§r lite intressant.\n\n\u003e Lusten att pyssla med s√•na h√§r programmeringssprojekt vid sidan av jobbet kommer och g√•r i perioder.\n\nDe h√§r problemen har uppst√•tt under en period d√• lusten f√∂r hobbyprogrammering √§r relativt l√•g. D√• tycker jag √§nd√• det √§r viktigt att inte tvinga sig sj√§lv att forts√§tta sitta framf√∂r datorn och knacka kod n√§r arbetsdagen √§r slut. D√• √§r det b√§ttre att g√∂ra n√•got annat, s√• kanske suget √§r tillbaka efter ett tag.\n","code":"var Component=(()=\u003e{var p=Object.create;var i=Object.defineProperty;var g=Object.getOwnPropertyDescriptor;var h=Object.getOwnPropertyNames;var m=Object.getPrototypeOf,f=Object.prototype.hasOwnProperty;var k=(e,t)=\u003e()=\u003e(t||e((t={exports:{}}).exports,t),t.exports),u=(e,t)=\u003e{for(var n in t)i(e,n,{get:t[n],enumerable:!0})},d=(e,t,n,s)=\u003e{if(t\u0026\u0026typeof t==\"object\"||typeof t==\"function\")for(let r of h(t))!f.call(e,r)\u0026\u0026r!==n\u0026\u0026i(e,r,{get:()=\u003et[r],enumerable:!(s=g(t,r))||s.enumerable});return e};var b=(e,t,n)=\u003e(n=e!=null?p(m(e)):{},d(t||!e||!e.__esModule?i(n,\"default\",{value:e,enumerable:!0}):n,e)),j=e=\u003ed(i({},\"__esModule\",{value:!0}),e);var o=k((D,l)=\u003e{l.exports=_jsx_runtime});var A={};u(A,{default:()=\u003ey,frontmatter:()=\u003ev});var a=b(o()),v={title:\"Hur Aftonbladet pajade min sajt och varf\\xF6r det \\xE4r okej att l\\xE5ta det ligga i backloggen tillsvidare\",summary:\"F\\xF6r ett tag sedan gjorde Aftonbladet ganska stora \\xE4ndringar p\\xE5 sin startsida som resulterade till att en av mina sajter i princip vart v\\xE4rdel\\xF6s. Men det \\xE4r helt okej!\",description:\"Aftonbladet har b\\xF6rjat med lazy loading p\\xE5 sin startsida. Det h\\xE4r h\\xE4nde d\\xE5 med min sajt/scraper.\",date:new Date(16257888e5)};function c(e){let t=Object.assign({h2:\"h2\",a:\"a\",span:\"span\",p:\"p\",img:\"img\",blockquote:\"blockquote\",strong:\"strong\",ul:\"ul\",li:\"li\",em:\"em\"},e.components);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(t.h2,{id:\"sajten\",children:[(0,a.jsx)(t.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#sajten\",children:(0,a.jsx)(t.span,{className:\"icon icon-link\"})}),\"Sajten\"]}),`\n`,(0,a.jsxs)(t.p,{children:[\"Jag har tidigare \",(0,a.jsx)(t.a,{href:\"/blogg/att-vacka-liv-i-ett-3-ar-gammalt-projekt\",children:\"skrivit lite\"}),\" om en sajt/scraper jag byggt - som via en api-endpoint parsa startsidan p\\xE5 Aftonbladet och sparar ned viss data om Aftonbladets startsida i Google Firebase.\"]}),`\n`,(0,a.jsx)(t.p,{children:\"Endpointen anropas dagligen klockan 12 och har nu fungerat felfritt i ett antal \\xE5r, fram till i \\xE5r.\"}),`\n`,(0,a.jsxs)(t.h2,{id:\"aftonbladet-f\\xF6rst\\xF6r-f\\xF6r-scrapern\",children:[(0,a.jsx)(t.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#aftonbladet-f\\xF6rst\\xF6r-f\\xF6r-scrapern\",children:(0,a.jsx)(t.span,{className:\"icon icon-link\"})}),\"Aftonbladet f\\xF6rst\\xF6r f\\xF6r scrapern\"]}),`\n`,(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{src:\"/img/posts/scraper-1.jpg\",alt:\"Data insamlat fr\\xE5n start\"})}),`\n`,(0,a.jsx)(t.p,{children:\"Bilden ovan illustrerar data f\\xF6r varje dag som scrapern har skannat av Aftonbladets startsida fr\\xE5n f\\xF6rsta dagen till skrivande stund (juli 2021).\"}),`\n`,(0,a.jsxs)(t.blockquote,{children:[`\n`,(0,a.jsx)(t.p,{children:\"N\\xE5got som \\xE4r helt orelaterat men \\xE4nd\\xE5 intressant \\xE4r om man tittar fr\\xE5n 2017-2019. Aftonbladet drog ned anv\\xE4ndandet av \\u2714 i sina artikelpuffar r\\xE4tt s\\xE5 mycket under den h\\xE4r perioden. Sedan pandemin drog ig\\xE5ng 2020 s\\xE5 gick anv\\xE4ndandet upp igen d\\xE4remot. Men nu var det inte det vi skulle fokusera p\\xE5.\"}),`\n`]}),`\n`,(0,a.jsx)(t.p,{children:\"I b\\xF6rjan p\\xE5 2021 s\\xE5 ser man n\\xE5got avvikande. Helt pl\\xF6tsligt f\\xE5ngar scrapern inte alls lika mycket data. Beror det p\\xE5 att anv\\xE4ndandet av \\u2714 har minskat?\"}),`\n`,(0,a.jsx)(t.p,{children:\"N\\xE4r jag uppt\\xE4ckte det h\\xE4r (lite i efterhand) s\\xE5 bes\\xF6kte jag Aftonbladet f\\xF6r att se vad som kan ha h\\xE4nt. Har dom \\xE4ndrat HTML-strukturen f\\xF6r att f\\xE5nga alla \\u2714?\"}),`\n`,(0,a.jsxs)(t.p,{children:[\"Jag skrollade runt p\\xE5 sajten och uppt\\xE4ckte att Aftonbladet laddar inte in hela startsidan p\\xE5 en g\\xE5ng l\\xE4ngre utan dom har implementerat \",(0,a.jsx)(t.strong,{children:\"Infinite scroll\"}),\" - inneh\\xE5ll laddar allt eftersom man skrollar.\"]}),`\n`,(0,a.jsx)(t.p,{children:\"Inte s\\xE5 konstigt att min scraper misslyckas med att samla in alla data korrekt allts\\xE5.\"}),`\n`,(0,a.jsxs)(t.p,{children:[`Kikar man p\\xE5 den h\\xE4r bilden s\\xE5 verkar det dessutom som att Aftonbladet lanserade denna feature 20/01/2021:\n`,(0,a.jsx)(t.img,{src:\"/img/posts/scraper-2.jpg\",alt:\"N\\xE4rbild p\\xE5 data\"})]}),`\n`,(0,a.jsx)(t.p,{children:\"Den dagen f\\xE5ngades bara 12 stycken checkar och sedan dess har mycket f\\xF6rre checkar sparats ned i Google Firebase.\"}),`\n`,(0,a.jsxs)(t.h2,{id:\"\\xE4nnu-f\\xE4rre-datapunkter-efter-ett-tag\",children:[(0,a.jsx)(t.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#\\xE4nnu-f\\xE4rre-datapunkter-efter-ett-tag\",children:(0,a.jsx)(t.span,{className:\"icon icon-link\"})}),\"\\xC4nnu f\\xE4rre datapunkter efter ett tag\"]}),`\n`,(0,a.jsx)(t.p,{children:\"Jaha. Min scraper f\\xE5ngar inte l\\xE4ngre alla checkar som anv\\xE4nds p\\xE5 startsidan. N\\xE4r jag uppt\\xE4ckte det h\\xE4r problemet gjorde jag dock inget \\xE5t det p\\xE5 en g\\xE5ng.\"}),`\n`,(0,a.jsxs)(t.p,{children:[`Jag h\\xF6ll d\\xE4remot lite koll under 2021 och kunde efter ett tag se det h\\xE4r fenomenet:\n`,(0,a.jsx)(t.img,{src:\"/img/posts/scraper-3.jpg\",alt:\"N\\xE4rbild p\\xE5 data\"})]}),`\n`,(0,a.jsxs)(t.p,{children:[\"Helt pl\\xF6tsligt f\\xE5ngades \",(0,a.jsx)(t.strong,{children:\"ingen data\"}),\" alls. Vad har Aftonbladet nu hittat p\\xE5? N\\xE4r jag uppt\\xE4ckte detta gick jag till deras startsida och kunde se att checkar ritades ju faktiskt ut.\"]}),`\n`,(0,a.jsx)(t.p,{children:\"Jag inspekterade HTML-koden och kunde se att checkarna d\\xE4remot ritades ut p\\xE5 ett nytt s\\xE4tt. Min scraper kunde inte urskilja dem d\\xE5 scrapern letade efter en css-klass som inte l\\xE4ngre anv\\xE4ndes f\\xF6r att rita ut checkarna.\"}),`\n`,(0,a.jsxs)(t.h2,{id:\"att-fixa-eller-inte-fixa\",children:[(0,a.jsx)(t.a,{\"aria-hidden\":\"true\",tabIndex:\"-1\",href:\"#att-fixa-eller-inte-fixa\",children:(0,a.jsx)(t.span,{className:\"icon icon-link\"})}),\"Att fixa eller inte fixa\"]}),`\n`,(0,a.jsx)(t.p,{children:\"Nu var allts\\xE5 min scraper helt trasig egentligen och skulle beh\\xF6va uppdateras:\"}),`\n`,(0,a.jsxs)(t.ul,{children:[`\n`,(0,a.jsx)(t.li,{children:\"Se till att hela startsidan l\\xE4ses in i scrapern f\\xF6r att f\\xE5nga alla checkar.\"}),`\n`,(0,a.jsx)(t.li,{children:\"Uppdatera scrapern f\\xF6r att identifiera checkarna p\\xE5 nytt.\"}),`\n`,(0,a.jsx)(t.li,{children:(0,a.jsx)(t.em,{children:\"(Nice to have) n\\xE5gon slags monitorering f\\xF6r att snabbare f\\xE5nga om scrapern f\\xE5ngar ett avvikande antal datapunkter.\"})}),`\n`]}),`\n`,(0,a.jsx)(t.p,{children:\"\\xC4r det h\\xE4r n\\xE5got jag har fixat? Nope\\u2026 Det h\\xE4r \\xE4r ju bara ett litet sidoprojekt, som dessutom inte kostar mig n\\xE5got i drift eller s\\xE5. Det k\\xE4nns inte heller v\\xE4rt att sl\\xE4cka ned sajten d\\xE5 den \\xE4nd\\xE5 har historisk data fr\\xE5n 2017 som \\xE4nd\\xE5 \\xE4r lite intressant.\"}),`\n`,(0,a.jsxs)(t.blockquote,{children:[`\n`,(0,a.jsx)(t.p,{children:\"Lusten att pyssla med s\\xE5na h\\xE4r programmeringssprojekt vid sidan av jobbet kommer och g\\xE5r i perioder.\"}),`\n`]}),`\n`,(0,a.jsx)(t.p,{children:\"De h\\xE4r problemen har uppst\\xE5tt under en period d\\xE5 lusten f\\xF6r hobbyprogrammering \\xE4r relativt l\\xE5g. D\\xE5 tycker jag \\xE4nd\\xE5 det \\xE4r viktigt att inte tvinga sig sj\\xE4lv att forts\\xE4tta sitta framf\\xF6r datorn och knacka kod n\\xE4r arbetsdagen \\xE4r slut. D\\xE5 \\xE4r det b\\xE4ttre att g\\xF6ra n\\xE5got annat, s\\xE5 kanske suget \\xE4r tillbaka efter ett tag.\"})]})}function x(e={}){let{wrapper:t}=e.components||{};return t?(0,a.jsx)(t,Object.assign({},e,{children:(0,a.jsx)(c,e)})):c(e)}var y=x;return j(A);})();\n;return Component;"},"_id":"posts/hur-aftonbladet-pajade-min-sajt-och-varfor-det-ar-okej-att-lata-det-ligga-i-backloggen-tillsvidare.mdx","_raw":{"sourceFilePath":"posts/hur-aftonbladet-pajade-min-sajt-och-varfor-det-ar-okej-att-lata-det-ligga-i-backloggen-tillsvidare.mdx","sourceFileName":"hur-aftonbladet-pajade-min-sajt-och-varfor-det-ar-okej-att-lata-det-ligga-i-backloggen-tillsvidare.mdx","sourceFileDir":"posts","contentType":"mdx","flattenedPath":"posts/hur-aftonbladet-pajade-min-sajt-och-varfor-det-ar-okej-att-lata-det-ligga-i-backloggen-tillsvidare"},"type":"Post","url":"/blogg/hur-aftonbladet-pajade-min-sajt-och-varfor-det-ar-okej-att-lata-det-ligga-i-backloggen-tillsvidare","dateFormatted":"2021-07-09"}},"__N_SSG":true},"page":"/blogg/[slug]","query":{"slug":"nar-man-formodligen-vill-byta-ut-use-state-mot-use-reducer"},"buildId":"TtVAyZFKtHZIk9MUUdl5Z","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>